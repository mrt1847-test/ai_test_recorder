{
  "version": 3,
  "sources": ["../src/content/utils/dom.js", "../src/content/selectors/index.js", "../src/content/dom/locator.js", "../src/content/replay/index.js", "../src/content/state.js", "../src/content/overlay/index.js", "../src/content/selection/index.js", "../src/content/events/schema.js", "../src/content/recorder/index.js", "../src/content/messaging/index.js", "../src/content/init.js", "../src/content/index.js"],
  "sourcesContent": ["/**\r\n * \uC140\uB809\uD130 \uC0DD\uC131/\uAC80\uC99D\uC5D0 \uD544\uC694\uD55C DOM \uAD00\uB828 \uC720\uD2F8\uB9AC\uD2F0 \uBAA8\uC74C.\r\n * CSS/XPath \uBB38\uC790\uC5F4 \uCC98\uB9AC, \uD14D\uC2A4\uD2B8 \uC815\uADDC\uD654, \uB9E4\uCE6D \uCE74\uC6B4\uD305 \uB4F1\uC744 \uC81C\uACF5\uD55C\uB2E4.\r\n */\r\n/**\r\n * \uC18D\uC131 \uAC12\uC5D0\uC11C \uB530\uC634\uD45C/\uC81C\uC5B4\uBB38\uC790\uB97C \uC774\uC2A4\uCF00\uC774\uD504\uD574 \uC548\uC804\uD55C \uBB38\uC790\uC5F4\uC744 \uB9CC\uB4E0\uB2E4.\r\n */\r\nexport function escapeAttributeValue(value) {\r\n  return (value || '').replace(/\"/g, '\\\\\"').replace(/\\u0008/g, '').replace(/\\u000c/g, '').trim();\r\n}\r\n\r\n/**\r\n * CSS selector\uC5D0\uC11C \uC0AC\uC6A9\uD560 \uC2DD\uBCC4\uC790\uB97C \uC774\uC2A4\uCF00\uC774\uD504\uD55C\uB2E4.\r\n */\r\nexport function cssEscapeIdent(value) {\r\n  if (typeof value !== 'string') return '';\r\n  if (window.CSS && typeof window.CSS.escape === 'function') {\r\n    return window.CSS.escape(value);\r\n  }\r\n  return value.replace(/([!\"#$%&'()*+,./:;<=>?@\\[\\]^`{|}~])/g, '\\\\$1');\r\n}\r\n\r\n/**\r\n * \uBB38\uC11C \uB8E8\uD2B8 \uAE30\uC900\uC73C\uB85C \uC694\uC18C\uC5D0 \uB300\uD55C Full XPath\uB97C \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nexport function buildFullXPath(el) {\r\n  if (!el || el.nodeType !== 1) return null;\r\n  if (el.id) {\r\n    const cleanedId = escapeAttributeValue(el.id);\r\n    if (cleanedId) {\r\n      return `//*[@id=\"${cleanedId}\"]`;\r\n    }\r\n  }\r\n  const parts = [];\r\n  let current = el;\r\n  while (current && current.nodeType === 1 && current !== document.documentElement) {\r\n    const tagName = current.tagName.toLowerCase();\r\n    let index = 1;\r\n    let sibling = current.previousSibling;\r\n    while (sibling) {\r\n      if (sibling.nodeType === 1 && sibling.tagName === current.tagName) {\r\n        index += 1;\r\n      }\r\n      sibling = sibling.previousSibling;\r\n    }\r\n    parts.unshift(`${tagName}[${index}]`);\r\n    current = current.parentNode;\r\n  }\r\n  if (parts.length === 0) return null;\r\n  return `//${parts.join('/')}`;\r\n}\r\n\r\nexport function buildCssSegment(el) {\r\n  if (!el || el.nodeType !== 1) return '';\r\n  const tag = el.tagName.toLowerCase();\r\n  let index = 1;\r\n  let sibling = el.previousElementSibling;\r\n  // \uC774\uC804 \uD615\uC81C \uC911 \uAC19\uC740 \uD0DC\uADF8\uAC00 \uBA87 \uBC88\uC9F8\uC778\uC9C0 \uACC4\uC0B0\uD55C\uB2E4.\r\n  while (sibling) {\r\n    if (sibling.nodeType === 1 && sibling.tagName === el.tagName) {\r\n      index += 1;\r\n    }\r\n    sibling = sibling.previousElementSibling;\r\n  }\r\n  if (el.id) {\r\n    return `${tag}#${cssEscapeIdent(el.id)}`;\r\n  }\r\n  const rawClassList = Array.from(el.classList || []).filter(Boolean);\r\n  const classList = rawClassList.slice(0, 2).map(cssEscapeIdent).filter(Boolean);\r\n  if (classList.length) {\r\n    const classSelector = `${tag}.${classList.join('.')}`;\r\n    const parent = el.parentElement;\r\n    if (parent) {\r\n      const requiredClasses = rawClassList.slice(0, classList.length);\r\n      // \uB3D9\uC77C\uD55C \uD074\uB798\uC2A4 \uC870\uD569\uC744 \uAC00\uC9C4 \uD615\uC81C \uC694\uC18C\uAC00 \uBA87 \uAC1C\uC778\uC9C0 \uD655\uC778\uD55C\uB2E4.\r\n      const matchingSiblings = Array.from(parent.children || []).filter((child) => {\r\n        if (!child || child.nodeType !== 1) return false;\r\n        if (child.tagName !== el.tagName) return false;\r\n        const childClasses = child.classList || [];\r\n        return requiredClasses.every((cls) => childClasses.contains ? childClasses.contains(cls) : childClasses.includes(cls));\r\n      }).length;\r\n      if (matchingSiblings > 1) {\r\n        return `${classSelector}:nth-of-type(${index})`;\r\n      }\r\n    }\r\n    return classSelector;\r\n  }\r\n  return `${tag}:nth-of-type(${index})`;\r\n}\r\n\r\nexport function buildRelativeCssSelector(parent, child) {\r\n  if (!parent || !child || !parent.contains(child) || parent === child) return null;\r\n  const segments = [];\r\n  let current = child;\r\n  while (current && current !== parent) {\r\n    // \uD14D\uC2A4\uD2B8 \uB178\uB4DC \uB4F1\uC740 \uAC74\uB108\uB6F4\uB2E4.\r\n    if (current.nodeType !== 1) {\r\n      current = current.parentElement;\r\n      continue;\r\n    }\r\n    const segment = buildCssSegment(current);\r\n    if (!segment) return null;\r\n    segments.unshift(segment);\r\n    current = current.parentElement;\r\n  }\r\n  if (current !== parent) return null;\r\n  return `:scope ${segments.join(' > ')}`;\r\n}\r\n\r\nexport function buildUniqueCssPath(element, contextElement) {\r\n  if (!element || element.nodeType !== 1) return null;\r\n  const segments = [];\r\n  let current = element;\r\n  while (current && current.nodeType === 1 && current !== contextElement) {\r\n    const segment = buildCssSegment(current);\r\n    if (!segment) return null;\r\n    segments.unshift(segment);\r\n    const cssPath = segments.join(' > ');\r\n    const selectorString = contextElement ? `:scope ${cssPath}` : cssPath;\r\n    const parsed = parseSelectorForMatching(`css=${selectorString}`, 'css');\r\n    const targetScope = contextElement || document;\r\n    const matchCount = countMatchesForSelector(parsed, targetScope);\r\n    // \uD604\uC7AC\uAE4C\uC9C0 \uC870\uD569\uD55C \uACBD\uB85C\uAC00 \uC720\uC77C\uD574\uC84C\uC73C\uBA74 \uBC18\uD658\uD55C\uB2E4.\r\n    if (matchCount === 1) {\r\n      if (!contextElement && cssPath.startsWith('html:nth-of-type(1) > ')) {\r\n        return cssPath.replace(/^html:nth-of-type\\(1\\)\\s*>\\s*/, '');\r\n      }\r\n      return contextElement ? `:scope ${cssPath}` : cssPath;\r\n    }\r\n    current = current.parentElement;\r\n    if (!current) break;\r\n    if (!contextElement && current === document.documentElement) {\r\n      break;\r\n    }\r\n  }\r\n  if (contextElement) {\r\n    const relativePath = segments.join(' > ');\r\n    return relativePath ? `:scope ${relativePath}` : null;\r\n  }\r\n  let finalPath = segments.join(' > ');\r\n  if (finalPath.startsWith('html:nth-of-type(1) > ')) {\r\n    finalPath = finalPath.replace(/^html:nth-of-type\\(1\\)\\s*>\\s*/, '');\r\n  }\r\n  return finalPath;\r\n}\r\n\r\nexport function escapeXPathLiteral(value) {\r\n  if (value.includes('\"') && value.includes(\"'\")) {\r\n    const parts = value.split('\"').map((part) => `\"${part}\"`).join(', \"\\\"\", ');\r\n    return `concat(${parts})`;\r\n  }\r\n  if (value.includes('\"')) {\r\n    return `'${value}'`;\r\n  }\r\n  return `\"${value}\"`;\r\n}\r\n\r\nexport function buildXPathSegment(el) {\r\n  if (!el || el.nodeType !== 1) return '';\r\n  const tag = el.tagName.toLowerCase();\r\n  if (el.id) {\r\n    return `${tag}[@id=${escapeXPathLiteral(el.id)}]`;\r\n  }\r\n  const classList = Array.from(el.classList || []).filter(Boolean);\r\n  if (classList.length) {\r\n    const cls = classList[0];\r\n    const containsExpr = `contains(concat(' ', normalize-space(@class), ' '), ${escapeXPathLiteral(' ' + cls + ' ')})`;\r\n    return `${tag}[${containsExpr}]`;\r\n  }\r\n  const attrPriority = ['data-testid', 'data-test', 'data-qa', 'data-cy', 'data-id', 'aria-label', 'role', 'name', 'type'];\r\n  // \uC6B0\uC120\uC21C\uC704 \uC18D\uC131\uB4E4 \uC911 \uD558\uB098\uB77C\uB3C4 \uC788\uC73C\uBA74 \uBC14\uB85C \uC0AC\uC6A9\uD55C\uB2E4.\r\n  for (const attr of attrPriority) {\r\n    const val = el.getAttribute && el.getAttribute(attr);\r\n    if (val) {\r\n      return `${tag}[@${attr}=${escapeXPathLiteral(val)}]`;\r\n    }\r\n  }\r\n  const nameAttr = el.getAttribute && el.getAttribute('name');\r\n  if (nameAttr) {\r\n    return `${tag}[@name=${escapeXPathLiteral(nameAttr)}]`;\r\n  }\r\n  let index = 1;\r\n  let sibling = el.previousElementSibling;\r\n  while (sibling) {\r\n    if (sibling.tagName === el.tagName) {\r\n      index += 1;\r\n    }\r\n    sibling = sibling.previousElementSibling;\r\n  }\r\n  return `${tag}[${index}]`;\r\n}\r\n\r\nexport function buildRelativeXPathSelector(parent, child) {\r\n  if (!parent || !child || !parent.contains(child) || parent === child) return null;\r\n  const segments = [];\r\n  let current = child;\r\n  while (current && current !== parent) {\r\n    // \uC694\uC18C \uB178\uB4DC\uAC00 \uC544\uB2C8\uBA74 \uC0C1\uC704\uB85C \uC774\uB3D9\uD55C\uB2E4.\r\n    if (current.nodeType !== 1) {\r\n      current = current.parentElement;\r\n      continue;\r\n    }\r\n    const segment = buildXPathSegment(current);\r\n    if (!segment) return null;\r\n    segments.unshift(segment);\r\n    current = current.parentElement;\r\n  }\r\n  if (current !== parent) return null;\r\n  return `.//${segments.join('/')}`;\r\n}\r\n\r\nexport function buildRobustXPathSegment(el) {\r\n  if (!el || el.nodeType !== 1) return null;\r\n  const tag = el.tagName.toLowerCase();\r\n  if (el.id) {\r\n    // id\uAC00 \uC788\uC73C\uBA74 \uB354 \uC774\uC0C1 \uC0C1\uC704 \uC694\uC18C\uB97C \uD0D0\uC0C9\uD560 \uD544\uC694 \uC5C6\uC73C\uB2C8 stop \uD50C\uB798\uADF8\uB97C \uC900\uB2E4.\r\n    return { segment: `//*[@id=${escapeXPathLiteral(el.id)}]`, stop: true };\r\n  }\r\n  const attrPriority = ['data-testid', 'data-test', 'data-qa', 'data-cy', 'data-id', 'aria-label', 'role', 'name', 'type'];\r\n  for (const attr of attrPriority) {\r\n    const val = el.getAttribute && el.getAttribute(attr);\r\n    if (val) {\r\n      return { segment: `${tag}[@${attr}=${escapeXPathLiteral(val)}]`, stop: false };\r\n    }\r\n  }\r\n  const classList = Array.from(el.classList || []).filter(Boolean);\r\n  if (classList.length) {\r\n    const cls = classList[0];\r\n    const containsExpr = `contains(concat(' ', normalize-space(@class), ' '), ${escapeXPathLiteral(' ' + cls + ' ')})`;\r\n    return { segment: `${tag}[${containsExpr}]`, stop: false };\r\n  }\r\n  let index = 1;\r\n  let sibling = el.previousElementSibling;\r\n  while (sibling) {\r\n    if (sibling.tagName === el.tagName) {\r\n      index += 1;\r\n    }\r\n    sibling = sibling.previousElementSibling;\r\n  }\r\n  return { segment: `${tag}[${index}]`, stop: false };\r\n}\r\n\r\nexport function buildRobustXPath(el) {\r\n  if (!el || el.nodeType !== 1) return null;\r\n  const segments = [];\r\n  let current = el;\r\n  while (current && current.nodeType === 1) {\r\n    // \uAC01 \uB2E8\uACC4\uBCC4\uB85C \uC18D\uC131 \uAE30\uBC18 XPath \uC870\uAC01\uC744 \uC0DD\uC131\uD55C\uB2E4.\r\n    const info = buildRobustXPathSegment(current);\r\n    if (!info || !info.segment) return null;\r\n    segments.unshift(info.segment);\r\n    // stop \uD50C\uB798\uADF8\uAC00 true\uC778 \uACBD\uC6B0 \uB8E8\uD504\uB97C \uC885\uB8CC\uD55C\uB2E4.\r\n    if (info.stop) break;\r\n    current = current.parentElement;\r\n  }\r\n  if (segments.length === 0) return null;\r\n  let xpath = segments[0];\r\n  if (xpath.startsWith('//*[@')) {\r\n    if (segments.length > 1) {\r\n      xpath += `/${segments.slice(1).join('/')}`;\r\n    }\r\n  } else {\r\n    xpath = `//${segments.join('/')}`;\r\n  }\r\n  return xpath;\r\n}\r\n\r\nexport function normalizeText(text) {\r\n  return (text || '').replace(/\\s+/g, ' ').trim();\r\n}\r\n\r\nexport function inferSelectorType(selector) {\r\n  if (!selector || typeof selector !== 'string') return null;\r\n  const trimmed = selector.trim();\r\n  if (trimmed.startsWith('xpath=')) return 'xpath';\r\n  if (trimmed.startsWith('//') || trimmed.startsWith('(')) return 'xpath';\r\n  if (trimmed.startsWith('text=')) return 'text';\r\n  if (trimmed.startsWith('#') || trimmed.startsWith('.') || trimmed.startsWith('[')) return 'css';\r\n  return 'css';\r\n}\r\n\r\nexport function parseSelectorForMatching(selector, explicitType) {\r\n  if (!selector) return { type: explicitType || null, value: '' };\r\n  let type = explicitType || inferSelectorType(selector);\r\n  let value = selector;\r\n  if (selector.startsWith('css=')) {\r\n    type = 'css';\r\n    value = selector.slice(4);\r\n  } else if (selector.startsWith('xpath=')) {\r\n    type = 'xpath';\r\n    value = selector.slice(6);\r\n  } else if (selector.startsWith('text=')) {\r\n    type = 'text';\r\n    value = selector.slice(5);\r\n  }\r\n  if (type === 'text') {\r\n    value = value.replace(/^['\"]|['\"]$/g, '');\r\n    value = value.replace(/\\\\\"/g, '\"').replace(/\\\\'/g, \"'\");\r\n  }\r\n  return { type, value };\r\n}\r\n\r\nexport function iterateElements(scope, callback) {\r\n  if (!scope || typeof callback !== 'function') return;\r\n  if (scope === document) {\r\n    // \uC804\uCCB4 \uBB38\uC11C\uC77C \uB54C\uB294 querySelectorAll('*')\uB85C \uC21C\uD68C.\r\n    document.querySelectorAll('*').forEach(callback);\r\n    return;\r\n  }\r\n  if (scope.nodeType === 1) {\r\n    // \uB2E8\uC77C \uC694\uC18C \uBC94\uC704\uB294 \uC790\uC2E0\uACFC \uC790\uC190\uC744 \uC21C\uD68C.\r\n    callback(scope);\r\n    scope.querySelectorAll('*').forEach(callback);\r\n  }\r\n}\r\n\r\nexport function buildTextXPathExpression(text, matchMode, scopeIsDocument) {\r\n  const literal = escapeXPathLiteral(text);\r\n  const base = scopeIsDocument ? '//' : './/';\r\n  if (matchMode === 'exact') {\r\n    return `${base}*[normalize-space(.) = ${literal}]`;\r\n  }\r\n  return `${base}*[contains(normalize-space(.), ${literal})]`;\r\n}\r\n\r\nexport function countMatchesForSelector(parsed, root, options = {}) {\r\n  if (!parsed || !parsed.value) return 0;\r\n  const scope = root || document;\r\n  const maxCount = typeof options.maxCount === 'number' && options.maxCount > 0 ? options.maxCount : Infinity;\r\n  const shouldClamp = Number.isFinite(maxCount);\r\n  try {\r\n    if (parsed.type === 'xpath') {\r\n      const doc = scope.ownerDocument || document;\r\n      const contextNode = scope.nodeType ? scope : doc;\r\n      const iterator = doc.evaluate(parsed.value, contextNode, null, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null);\r\n      let count = 0;\r\n      let node = iterator.iterateNext();\r\n      // XPath \uACB0\uACFC\uB97C \uD558\uB098\uC529 \uC21C\uD68C\uD558\uBA74\uC11C \uAC1C\uC218\uB97C \uC13C\uB2E4.\r\n      while (node) {\r\n        count += 1;\r\n        if (shouldClamp && count >= maxCount) {\r\n          return maxCount;\r\n        }\r\n        node = iterator.iterateNext();\r\n      }\r\n      return count;\r\n    }\r\n    if (parsed.type === 'text') {\r\n      const targetText = normalizeText(parsed.value);\r\n      if (!targetText) return 0;\r\n      const doc = scope.ownerDocument || document;\r\n      const contextNode = scope.nodeType ? scope : doc;\r\n      const isDocumentScope = !scope || scope === document || scope.nodeType === 9;\r\n      const matchMode = options.matchMode === 'contains' ? 'contains' : 'exact';\r\n      const expression = buildTextXPathExpression(targetText, matchMode, isDocumentScope);\r\n      const iterator = doc.evaluate(expression, contextNode, null, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null);\r\n      let count = 0;\r\n      let node = iterator.iterateNext();\r\n      // \uD14D\uC2A4\uD2B8 \uAE30\uBC18 XPath\uB3C4 \uB3D9\uC77C\uD558\uAC8C \uBC18\uBCF5\uD558\uBA70 \uAC1C\uC218\uB97C \uACC4\uC0B0.\r\n      while (node) {\r\n        count += 1;\r\n        if (shouldClamp && count >= maxCount) {\r\n          return maxCount;\r\n        }\r\n        node = iterator.iterateNext();\r\n      }\r\n      return count;\r\n    }\r\n    const result = scope.querySelectorAll(parsed.value);\r\n    if (!shouldClamp) {\r\n      if (scope === document) {\r\n        return result.length;\r\n      }\r\n      let count = result.length;\r\n      // \uC2A4\uCF54\uD504 \uC790\uCCB4\uB3C4 \uC140\uB809\uD130\uC640 \uC77C\uCE58\uD558\uBA74 \uCD94\uAC00\uB85C \uCE74\uC6B4\uD2B8.\r\n      if (scope.matches && scope.matches(parsed.value)) {\r\n        count += 1;\r\n      }\r\n      return count;\r\n    }\r\n    let count = 0;\r\n    for (let i = 0; i < result.length; i += 1) {\r\n      count += 1;\r\n      if (count >= maxCount) {\r\n        return maxCount;\r\n      }\r\n    }\r\n    if (scope !== document && scope.matches && scope.matches(parsed.value)) {\r\n      count += 1;\r\n      if (count >= maxCount) {\r\n        return maxCount;\r\n      }\r\n    }\r\n    return count;\r\n  } catch (err) {\r\n    return 0;\r\n  }\r\n}\r\n\r\nconst CONTEXT_ATTRIBUTE_KEYS = [\r\n  'data-testid',\r\n  'data-test',\r\n  'data-qa',\r\n  'data-cy',\r\n  'data-id',\r\n  'aria-label',\r\n  'role',\r\n  'name',\r\n  'type',\r\n  'alt',\r\n  'title'\r\n];\r\n\r\nfunction pickContextAttributes(element) {\r\n  const attrs = {};\r\n  CONTEXT_ATTRIBUTE_KEYS.forEach((key) => {\r\n    const value = element.getAttribute && element.getAttribute(key);\r\n    if (value) {\r\n      attrs[key] = value;\r\n    }\r\n  });\r\n  return attrs;\r\n}\r\n\r\nfunction getElementPositionInfo(element) {\r\n  const parent = element.parentElement;\r\n  let index = 0;\r\n  let nthOfType = 0;\r\n  let total = 1;\r\n  if (parent) {\r\n    const children = Array.from(parent.children || []);\r\n    total = children.length;\r\n    index = children.indexOf(element);\r\n    nthOfType = children\r\n      // \uD604\uC7AC \uC694\uC18C\uC640 \uAC19\uC740 \uD0DC\uADF8\uB97C \uAC00\uC9C4 \uD615\uC81C\uB9CC \uC138\uC5B4 nth-of-type \uC815\uBCF4\uB97C \uB9CC\uB4E0\uB2E4.\r\n      .slice(0, index + 1)\r\n      .filter((el) => el.tagName === element.tagName).length;\r\n  } else {\r\n    nthOfType = 1;\r\n  }\r\n  return {\r\n    index,\r\n    total,\r\n    nthOfType\r\n  };\r\n}\r\n\r\nfunction summarizeElementForContext(element) {\r\n  if (!element || element.nodeType !== 1) return null;\r\n  const summary = {\r\n    tag: element.tagName ? element.tagName.toLowerCase() : ''\r\n  };\r\n  if (element.id) {\r\n    summary.id = element.id;\r\n  }\r\n  const classes = Array.from(element.classList || []).slice(0, 5);\r\n  if (classes.length) {\r\n    summary.classes = classes;\r\n  }\r\n  const attrs = pickContextAttributes(element);\r\n  if (Object.keys(attrs).length > 0) {\r\n    summary.attributes = attrs;\r\n  }\r\n  const rawText = normalizeText((element.innerText || element.textContent || '').trim());\r\n  if (rawText) {\r\n    summary.text = rawText.length > 80 ? `${rawText.slice(0, 77)}\u2026` : rawText;\r\n  }\r\n  summary.childCount = element.children ? element.children.length : 0;\r\n  summary.position = getElementPositionInfo(element);\r\n  return summary;\r\n}\r\n\r\nexport function buildDomContextSnapshot(element, options = {}) {\r\n  if (!element || element.nodeType !== 1) {\r\n    return {\r\n      ancestors: [],\r\n      children: []\r\n    };\r\n  }\r\n  const {\r\n    maxAncestors = 4,\r\n    maxChildren = 6,\r\n    includeSelf = false\r\n  } = options;\r\n\r\n  const ancestors = [];\r\n  let current = element.parentElement;\r\n  // \uCD5C\uB300 maxAncestors\uAC1C\uAE4C\uC9C0 \uC0C1\uC704 \uC694\uC18C\uB97C \uC694\uC57D\uD55C\uB2E4.\r\n  while (current && ancestors.length < maxAncestors) {\r\n    const summary = summarizeElementForContext(current);\r\n    if (summary) {\r\n      ancestors.push(summary);\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  const children = [];\r\n  const childElements = Array.from(element.children || []);\r\n  // \uCD5C\uB300 maxChildren\uAC1C\uAE4C\uC9C0 \uC790\uC2DD \uC694\uC18C \uC694\uC57D\uC744 \uC791\uC131\uD55C\uB2E4.\r\n  childElements.slice(0, maxChildren).forEach((child) => {\r\n    const summary = summarizeElementForContext(child);\r\n    if (summary) {\r\n      children.push(summary);\r\n    }\r\n  });\r\n\r\n  return {\r\n    self: includeSelf ? summarizeElementForContext(element) : undefined,\r\n    ancestors,\r\n    children\r\n  };\r\n}\r\n\r\n", "/**\r\n * DOM \uC694\uC18C\uC5D0\uC11C \uB2E4\uC591\uD55C \uC720\uD615\uC758 \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uCD94\uCD9C\uD558\uACE0 \uC815\uB82C\uD55C\uB2E4.\r\n * CSS/XPath/\uD14D\uC2A4\uD2B8 \uAE30\uBC18 \uD6C4\uBCF4\uB97C \uC0DD\uC131\uD558\uACE0 \uC720\uC77C\uC131 \uAC80\uC0AC\uB97C \uC218\uD589\uD55C\uB2E4.\r\n */\r\nimport {\r\n  buildFullXPath,\r\n  buildRelativeCssSelector,\r\n  buildRelativeXPathSelector,\r\n  buildRobustXPath,\r\n  buildUniqueCssPath,\r\n  countMatchesForSelector,\r\n  escapeAttributeValue,\r\n  cssEscapeIdent,\r\n  inferSelectorType,\r\n  normalizeText,\r\n  parseSelectorForMatching,\r\n  escapeXPathLiteral\r\n} from '../utils/dom.js';\r\n\r\nconst DEFAULT_TEXT_SCORE = 65;\r\nconst DEFAULT_TAG_SCORE = 20;\r\nconst UNIQUE_MATCH_BONUS = 6;\r\nconst DUPLICATE_PENALTY_STEP = 6;\r\nconst CLASS_COMBINATION_LIMIT = 3;\r\nconst MAX_CLASS_COMBINATIONS = 24;\r\nconst TEXT_PARENT_MAX_DEPTH = 4;\r\nconst TEXT_PARENT_CLASS_LIMIT = 4;\r\nconst TEXT_PARENT_COMBINATION_LIMIT = 3;\r\nconst TEXT_PARENT_MAX_COMBINATIONS = 12;\r\n\r\nconst CSS_PARENT_MAX_DEPTH = 3;\r\nconst CSS_PARENT_CLASS_LIMIT = 4;\r\nconst CSS_PARENT_COMBINATION_LIMIT = 3;\r\nconst CSS_PARENT_MAX_COMBINATIONS = 20;\r\nconst CSS_SIMPLE_PARENT_MAX_DEPTH = 4;\r\n\r\nconst SELECTOR_TYPE_PRIORITY = {\r\n  id: 100,\r\n  'data-testid': 96,\r\n  'data-test': 95,\r\n  'data-qa': 94,\r\n  'data-cy': 94,\r\n  'data-id': 92,\r\n  'aria-label': 90,\r\n  name: 88,\r\n  role: 85,\r\n  title: 82,\r\n  text: 78,\r\n  css: 70,\r\n  'class-tag': 66,\r\n  class: 62,\r\n  tag: 40,\r\n  xpath: 30,\r\n  'xpath-full': 5\r\n};\r\n\r\nconst ATTRIBUTE_PRIORITY = [\r\n  { attr: 'id', type: 'id', score: 90, reason: 'id \uC18D\uC131', allowPartial: false },\r\n  { attr: 'data-testid', type: 'data-testid', score: 88, reason: 'data-testid \uC18D\uC131', allowPartial: true },\r\n  { attr: 'data-test', type: 'data-test', score: 86, reason: 'data-test \uC18D\uC131', allowPartial: true },\r\n  { attr: 'data-qa', type: 'data-qa', score: 84, reason: 'data-qa \uC18D\uC131', allowPartial: true },\r\n  { attr: 'data-cy', type: 'data-cy', score: 84, reason: 'data-cy \uC18D\uC131', allowPartial: true },\r\n  { attr: 'data-id', type: 'data-id', score: 82, reason: 'data-id \uC18D\uC131', allowPartial: true },\r\n  { attr: 'aria-label', type: 'aria-label', score: 80, reason: 'aria-label \uC18D\uC131', allowPartial: true },\r\n  { attr: 'role', type: 'role', score: 78, reason: 'role \uC18D\uC131', allowPartial: false },\r\n  { attr: 'name', type: 'name', score: 78, reason: 'name \uC18D\uC131', allowPartial: false },\r\n  { attr: 'title', type: 'title', score: 72, reason: 'title \uC18D\uC131', allowPartial: true },\r\n  { attr: 'type', type: 'type', score: 68, reason: 'type \uC18D\uC131', allowPartial: false }\r\n];\r\n\r\n/**\r\n * \uB2E8\uC77C \uC694\uC18C\uC5D0\uC11C \uC18D\uC131 \uAE30\uBC18 \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uC0DD\uC131\uD55C\uB2E4.\r\n * \uC6B0\uC120\uC21C\uC704\uB97C \uC815\uC758\uD55C ATTRIBUTE_PRIORITY\uC5D0 \uB530\uB77C \uCC98\uB9AC\uD55C\uB2E4.\r\n */\r\nfunction buildAttributeSelectors(element) {\r\n  const results = [];\r\n  // \uBBF8\uB9AC \uC815\uC758\uB41C \uC18D\uC131 \uBAA9\uB85D\uC744 \uC21C\uD68C\uD558\uBA74\uC11C \uD6C4\uBCF4\uB97C \uB9CC\uB4E0\uB2E4.\r\n  for (const meta of ATTRIBUTE_PRIORITY) {\r\n    const rawValue = element.getAttribute && element.getAttribute(meta.attr);\r\n    if (!rawValue) continue;\r\n\r\n    if (meta.attr === 'id') {\r\n      results.push({\r\n        type: 'id',\r\n        selector: `#${cssEscapeIdent(rawValue)}`,\r\n        score: meta.score,\r\n        reason: meta.reason\r\n      });\r\n      continue;\r\n    }\r\n\r\n    const escaped = escapeAttributeValue(rawValue);\r\n    results.push({\r\n      type: meta.type,\r\n      selector: `[${meta.attr}=\"${escaped}\"]`,\r\n      score: meta.score,\r\n      reason: meta.reason\r\n    });\r\n\r\n    if (meta.allowPartial) {\r\n      // \uACF5\uBC31/\uC27C\uD45C \uB4F1\uC744 \uAE30\uC900\uC73C\uB85C \uBD80\uBD84 \uB9E4\uCE6D \uC140\uB809\uD130\uB97C \uCD94\uAC00\uD55C\uB2E4.\r\n      const tokens = rawValue.split(/[\\s,;]+/).filter((token) => token.length > 2);\r\n      tokens.slice(0, 2).forEach((token, index) => {\r\n        const escapedToken = escapeAttributeValue(token);\r\n        results.push({\r\n          type: `${meta.type}-partial`,\r\n          selector: `[${meta.attr}*=\"${escapedToken}\"]`,\r\n          score: Math.max(meta.score - 8 - index * 2, 60),\r\n          reason: `${meta.reason} \uBD80\uBD84 \uC77C\uCE58`,\r\n          matchMode: 'contains'\r\n        });\r\n      });\r\n    }\r\n  }\r\n  return results;\r\n}\r\n\r\n/**\r\n * \uC694\uC18C\uC758 classList\uB97C \uD65C\uC6A9\uD574 class \uC870\uD569 \uAE30\uBC18 \uC140\uB809\uD130\uB97C \uB9CC\uB4E0\uB2E4.\r\n */\r\nfunction generateClassSelectors(element) {\r\n  const classList = Array.from(element.classList || []).filter(Boolean);\r\n  if (classList.length === 0) return [];\r\n\r\n  const escaped = classList.map((cls) => cssEscapeIdent(cls));\r\n  const combinations = new Set();\r\n\r\n  // class \uC870\uD569\uC744 \uBC31\uD2B8\uB798\uD0B9\uC73C\uB85C \uC0DD\uC131\uD55C\uB2E4.\r\n  function backtrack(start, depth, current) {\r\n    if (current.length > 0 && current.length <= CLASS_COMBINATION_LIMIT) {\r\n      const key = current.join('.');\r\n      combinations.add(key);\r\n    }\r\n    if (current.length === CLASS_COMBINATION_LIMIT) return;\r\n    for (let i = start; i < escaped.length; i += 1) {\r\n      current.push(escaped[i]);\r\n      backtrack(i + 1, depth + 1, current);\r\n      current.pop();\r\n    }\r\n  }\r\n\r\n  backtrack(0, 0, []);\r\n\r\n  const results = [];\r\n  const ordered = Array.from(combinations).sort((a, b) => {\r\n    const lenDiff = a.split('.').length - b.split('.').length;\r\n    if (lenDiff !== 0) return lenDiff;\r\n    return a.localeCompare(b);\r\n  });\r\n  ordered.slice(0, MAX_CLASS_COMBINATIONS).forEach((key) => {\r\n    const classSelector = `.${key}`;\r\n    results.push({\r\n      type: 'class',\r\n      selector: classSelector,\r\n      score: 62 - Math.min(10, key.split('.').length * 2),\r\n      reason: 'class \uC870\uD569'\r\n    });\r\n    results.push({\r\n      type: 'class-tag',\r\n      selector: `${element.tagName.toLowerCase()}${classSelector}`,\r\n      score: 68 - Math.min(10, key.split('.').length),\r\n      reason: '\uD0DC\uADF8 + class \uC870\uD569'\r\n    });\r\n  });\r\n\r\n  return results;\r\n}\r\n\r\n/**\r\n * \uC140\uB809\uD130 \uC720\uD615\uC5D0 \uB530\uB77C \uC6B0\uC120\uC21C\uC704 \uC810\uC218\uB97C \uBC18\uD658\uD55C\uB2E4.\r\n */\r\nfunction getSelectorTypeRank(candidate) {\r\n  if (!candidate) return 0;\r\n  const type = candidate.type || inferSelectorType(candidate.selector);\r\n  if (!type) return 0;\r\n  if (Object.prototype.hasOwnProperty.call(SELECTOR_TYPE_PRIORITY, type)) {\r\n    return SELECTOR_TYPE_PRIORITY[type];\r\n  }\r\n  if (type.startsWith('data-')) return 90;\r\n  if (type.includes('partial')) return 75;\r\n  return 50;\r\n}\r\n\r\n/**\r\n * \uD6C4\uBCF4 \uC140\uB809\uD130 \uBC30\uC5F4\uC744 \uC720\uC77C\uC131/\uAD00\uACC4/\uD0C0\uC785 \uC810\uC218\uB97C \uAE30\uC900\uC73C\uB85C \uC815\uB82C\uD55C\uB2E4.\r\n * \uC720\uC77C \uD6C4\uBCF4 > relative \uD6C4\uBCF4 > \uD0C0\uC785 \uC6B0\uC120\uC21C\uC704 > \uC810\uC218 \uC21C\uC73C\uB85C \uC815\uB82C\uD55C\uB2E4.\r\n */\r\nfunction sortCandidates(candidates) {\r\n  return candidates\r\n    .slice()\r\n    .sort((a, b) => {\r\n      const uniqueA = a.unique ? 1 : 0;\r\n      const uniqueB = b.unique ? 1 : 0;\r\n      if (uniqueA !== uniqueB) return uniqueB - uniqueA;\r\n      const relationA = a.relation === 'relative' ? 1 : 0;\r\n      const relationB = b.relation === 'relative' ? 1 : 0;\r\n      if (relationA !== relationB) return relationB - relationA;\r\n      const typeRankA = getSelectorTypeRank(a);\r\n      const typeRankB = getSelectorTypeRank(b);\r\n      if (typeRankA !== typeRankB) return typeRankB - typeRankA;\r\n      return (b.score || 0) - (a.score || 0);\r\n    });\r\n}\r\n\r\nfunction buildClassCombinationLists(classes, options = {}) {\r\n  const {\r\n    limit = TEXT_PARENT_COMBINATION_LIMIT,\r\n    maxResults = TEXT_PARENT_MAX_COMBINATIONS,\r\n    classLimit = TEXT_PARENT_CLASS_LIMIT\r\n  } = options;\r\n  const uniqueClasses = Array.from(new Set(classes)).filter(Boolean).slice(0, classLimit);\r\n  const combos = [];\r\n  // class \uC870\uD569 \uC218\uB97C \uC81C\uD55C\uD558\uBA74\uC11C \uBAA8\uB4E0 \uC870\uD569\uC744 \uC0DD\uC131\uD55C\uB2E4.\r\n  function backtrack(start, current) {\r\n    if (current.length > 0 && combos.length < maxResults) {\r\n      combos.push([...current]);\r\n    }\r\n    if (current.length === limit) return;\r\n    for (let i = start; i < uniqueClasses.length && combos.length < maxResults; i += 1) {\r\n      current.push(uniqueClasses[i]);\r\n      backtrack(i + 1, current);\r\n      current.pop();\r\n    }\r\n  }\r\n  backtrack(0, []);\r\n  return combos;\r\n}\r\n\r\n/**\r\n * \uD14D\uC2A4\uD2B8 \uAE30\uBC18 \uC140\uB809\uD130\uAC00 \uC720\uC77C\uD558\uC9C0 \uC54A\uC744 \uB54C \uC0C1\uC704 \uC694\uC18C \uC815\uBCF4\uB97C \uACB0\uD569\uD55C XPath\uB97C \uC2DC\uB3C4\uD55C\uB2E4.\r\n */\r\nfunction tryBuildAncestorTextXPath(element, textValue, matchMode) {\r\n  if (!element || !textValue) return null;\r\n  const normalized = normalizeText(textValue);\r\n  // \uD14D\uC2A4\uD2B8\uAC00 \uBE44\uC5B4 \uC788\uC73C\uBA74 \uB354 \uC774\uC0C1 \uC9C4\uD589\uD560 \uC218 \uC5C6\uB2E4.\r\n  if (!normalized) return null;\r\n  const literal = escapeXPathLiteral(normalized);\r\n  const textExpr = matchMode === 'contains'\r\n    ? `contains(normalize-space(.), ${literal})`\r\n    : `normalize-space(.) = ${literal}`;\r\n  const elementClassList = Array.from(element.classList || []).filter(Boolean);\r\n  if (elementClassList.length) {\r\n    // \uC6D0\uBCF8 \uC694\uC18C\uC758 \uD074\uB798\uC2A4 \uBAA9\uB85D\uC744 \uD65C\uC6A9\uD574 XPath \uD6C4\uBCF4\uB97C \uB9CC\uB4E0\uB2E4.\r\n    for (const cls of elementClassList.slice(0, TEXT_PARENT_CLASS_LIMIT)) {\r\n      const literalClass = escapeXPathLiteral(cls);\r\n      const tagName = element.tagName ? element.tagName.toLowerCase() : '*';\r\n      // \uD074\uB798\uC2A4\uC640 \uD14D\uC2A4\uD2B8 \uC870\uD569\uC73C\uB85C \uAD6C\uC131 \uAC00\uB2A5\uD55C XPath \uD6C4\uBCF4\uB97C \uB098\uC5F4\uD55C\uB2E4.\r\n      const candidates = [\r\n        `//*[@class=${literalClass} and normalize-space(.) = ${literal}]`,\r\n        `//*[@class=${literalClass} and contains(normalize-space(.), ${literal})]`,\r\n        `//${tagName}[@class=${literalClass} and normalize-space(.) = ${literal}]`,\r\n        `//${tagName}[@class=${literalClass} and contains(normalize-space(.), ${literal})]`\r\n      ];\r\n      for (const xpathExpr of candidates) {\r\n        const selector = `xpath=${xpathExpr}`;\r\n        const parsed = parseSelectorForMatching(selector, 'xpath');\r\n        const count = countMatchesForSelector(parsed, document, { matchMode });\r\n        // \uD55C \uBC88\uB9CC \uB9E4\uCE6D\uB418\uBA74 \uC989\uC2DC \uD574\uB2F9 \uC140\uB809\uD130\uB97C \uBC18\uD658\uD55C\uB2E4.\r\n        if (count === 1) {\r\n          const isTagVariant = xpathExpr.startsWith(`//${tagName}`);\r\n          return {\r\n            selector,\r\n            count,\r\n            reason: isTagVariant ? '\uD0DC\uADF8+\uD074\uB798\uC2A4 + \uD14D\uC2A4\uD2B8 \uC870\uD569' : '\uD074\uB798\uC2A4 + \uD14D\uC2A4\uD2B8 \uC870\uD569'\r\n          };\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  let current = element.parentElement;\r\n  let depth = 0;\r\n  while (current && depth < TEXT_PARENT_MAX_DEPTH) {\r\n    depth += 1;\r\n    if (current.nodeType !== 1) {\r\n      // \uD14D\uC2A4\uD2B8 \uB178\uB4DC \uB4F1\uC740 \uAC74\uB108\uB6F4\uB2E4.\r\n      current = current.parentElement;\r\n      continue;\r\n    }\r\n    const classList = Array.from(current.classList || []).filter(Boolean);\r\n    const tagName = current.tagName ? current.tagName.toLowerCase() : '*';\r\n    if (classList.length > 0) {\r\n      for (const cls of classList.slice(0, TEXT_PARENT_CLASS_LIMIT)) {\r\n        const classLiteral = escapeXPathLiteral(cls);\r\n        const classXPath = `//*[@class=${classLiteral}]//*[${textExpr}]`;\r\n        const classSelector = `xpath=${classXPath}`;\r\n        const classParsed = parseSelectorForMatching(classSelector, 'xpath');\r\n        const classCount = countMatchesForSelector(classParsed, document, { matchMode });\r\n        // \uD074\uB798\uC2A4 \uC870\uD569\uC73C\uB85C \uC720\uC77C\uD574\uC9C0\uBA74 \uBC14\uB85C \uBC18\uD658.\r\n        if (classCount === 1) {\r\n          return {\r\n            selector: classSelector,\r\n            count: classCount,\r\n            reason: '\uC0C1\uC704 \uD074\uB798\uC2A4 + \uD14D\uC2A4\uD2B8 \uC870\uD569'\r\n          };\r\n        }\r\n        const tagClassXPath = `//${tagName}[@class=${classLiteral}]//*[${textExpr}]`;\r\n        const tagClassSelector = `xpath=${tagClassXPath}`;\r\n        const tagClassParsed = parseSelectorForMatching(tagClassSelector, 'xpath');\r\n        const tagClassCount = countMatchesForSelector(tagClassParsed, document, { matchMode });\r\n        // \uD0DC\uADF8+\uD074\uB798\uC2A4 \uC870\uD569\uB3C4 \uC720\uC77C\uD574\uC9C0\uBA74 \uBC18\uD658.\r\n        if (tagClassCount === 1) {\r\n          return {\r\n            selector: tagClassSelector,\r\n            count: tagClassCount,\r\n            reason: '\uC0C1\uC704 \uD0DC\uADF8+\uD074\uB798\uC2A4 + \uD14D\uC2A4\uD2B8 \uC870\uD569'\r\n          };\r\n        }\r\n      }\r\n    } else if (tagName && tagName !== '*') {\r\n      const tagOnlyXPath = `//${tagName}[${textExpr}]`;\r\n      const tagOnlySelector = `xpath=${tagOnlyXPath}`;\r\n      const tagOnlyParsed = parseSelectorForMatching(tagOnlySelector, 'xpath');\r\n      const tagOnlyCount = countMatchesForSelector(tagOnlyParsed, document, { matchMode });\r\n      // \uD0DC\uADF8\uB9CC\uC73C\uB85C \uC720\uC77C\uD574\uC9C0\uB294 \uACBD\uC6B0\uB3C4 \uACE0\uB824\uD55C\uB2E4.\r\n      if (tagOnlyCount === 1) {\r\n        return {\r\n          selector: tagOnlySelector,\r\n          count: tagOnlyCount,\r\n          reason: '\uC0C1\uC704 \uD0DC\uADF8 + \uD14D\uC2A4\uD2B8 \uC870\uD569'\r\n        };\r\n      }\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * \uD6C4\uBCF4 \uAC1D\uCCB4\uC5D0\uC11C CSS \uAD00\uB828 \uC140\uB809\uD130 \uBB38\uC790\uC5F4\uC744 \uCD94\uCD9C\uD55C\uB2E4.\r\n */\r\nfunction extractCssSelector(candidate) {\r\n  if (!candidate) return null;\r\n  const selector = candidate.selector || '';\r\n  const type = candidate.type || inferSelectorType(selector);\r\n  if (type === 'css') {\r\n    // css= \uC811\uB450\uC0AC\uAC00 \uC788\uC73C\uBA74 \uC81C\uAC70\uD55C\uB2E4.\r\n    return selector.startsWith('css=') ? selector.slice(4) : selector;\r\n  }\r\n  if (type === 'class' || type === 'class-tag' || type === 'id' || type === 'tag') {\r\n    return selector;\r\n  }\r\n  if (type === 'text') return null;\r\n  return null;\r\n}\r\n\r\n/**\r\n * CSS \uC140\uB809\uD130\uAC00 \uC911\uBCF5\uB420 \uB54C \uC0C1\uC704 \uC694\uC18C \uACBD\uB85C\uB97C \uD655\uC7A5\uD558\uC5EC \uC720\uC77C\uD55C \uC140\uB809\uD130\uB97C \uCC3E\uB294\uB2E4.\r\n */\r\nfunction tryBuildAncestorCssSelector(element, baseSelector, contextElement) {\r\n  if (!element || !baseSelector) return null;\r\n  const base = baseSelector.startsWith('css=') ? baseSelector.slice(4).trim() : baseSelector.trim();\r\n  if (!base) return null;\r\n  const tested = new Set();\r\n  const scopedPrefix = contextElement ? ':scope ' : '';\r\n  let current = element.parentElement;\r\n  let depth = 0;\r\n  let paths = [base];\r\n  while (current && depth < CSS_PARENT_MAX_DEPTH && paths.length) {\r\n    depth += 1;\r\n    if (current.nodeType !== 1) {\r\n      // \uC694\uC18C \uB178\uB4DC\uAC00 \uC544\uB2C8\uBA74 \uC0C1\uC704\uB85C \uACC4\uC18D \uC62C\uB77C\uAC04\uB2E4.\r\n      current = current.parentElement;\r\n      continue;\r\n    }\r\n    const ancestorSelectors = [];\r\n    if (current.id) {\r\n      // \uACE0\uC720 id\uAC00 \uC788\uC73C\uBA74 \uCD5C\uC6B0\uC120\uC73C\uB85C \uACE0\uB824.\r\n      ancestorSelectors.push(`#${cssEscapeIdent(current.id)}`);\r\n    }\r\n    const classList = Array.from(current.classList || []).filter(Boolean);\r\n    if (classList.length) {\r\n      const combos = buildClassCombinationLists(classList, {\r\n        limit: CSS_PARENT_COMBINATION_LIMIT,\r\n        maxResults: CSS_PARENT_MAX_COMBINATIONS,\r\n        classLimit: CSS_PARENT_CLASS_LIMIT\r\n      });\r\n      combos.forEach((combo) => {\r\n        const escaped = combo.map((cls) => cssEscapeIdent(cls));\r\n        if (escaped.length) {\r\n          ancestorSelectors.push(`.${escaped.join('.')}`);\r\n          const tag = current.tagName ? current.tagName.toLowerCase() : '*';\r\n          ancestorSelectors.push(`${tag}.${escaped.join('.')}`);\r\n        }\r\n      });\r\n    }\r\n    const tagName = current.tagName ? current.tagName.toLowerCase() : '*';\r\n    // \uD0DC\uADF8 \uC774\uB984\uB9CC\uC73C\uB85C\uB3C4 \uD6C4\uBCF4\uB97C \uCD94\uAC00\uD55C\uB2E4.\r\n    ancestorSelectors.push(tagName);\r\n\r\n    const newPaths = [];\r\n    for (const ancestorSelector of ancestorSelectors) {\r\n      for (const path of paths) {\r\n        const directSelector = `${ancestorSelector} > ${path}`;\r\n        const descendantSelector = `${ancestorSelector} ${path}`;\r\n        const candidates = [directSelector, descendantSelector];\r\n        for (const candidatePath of candidates) {\r\n          const normalized = candidatePath.trim();\r\n          if (!normalized || tested.has(normalized)) continue;\r\n          tested.add(normalized);\r\n          const fullSelector = contextElement ? `:scope ${normalized}` : normalized;\r\n          const parsed = parseSelectorForMatching(`css=${fullSelector}`, 'css');\r\n          const targetScope = contextElement || document;\r\n          const count = countMatchesForSelector(parsed, targetScope);\r\n          // \uC720\uC77C\uD558\uAC8C \uB9E4\uCE6D\uB418\uBA74 \uC989\uC2DC \uBC18\uD658.\r\n          if (count === 1) {\r\n            return {\r\n              selector: `css=${fullSelector}`,\r\n              count\r\n            };\r\n          }\r\n          newPaths.push(normalized);\r\n        }\r\n      }\r\n    }\r\n    paths = Array.from(new Set(newPaths)).slice(0, CSS_PARENT_MAX_COMBINATIONS);\r\n    current = current.parentElement;\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * \uAC04\uB2E8\uD55C \uBD80\uBAA8 \uCCB4\uC778\uB9CC \uB530\uB77C\uAC00\uBA70 CSS \uC140\uB809\uD130\uC5D0 \uBD80\uBAA8 \uACBD\uB85C\uB97C \uCD94\uAC00\uD55C\uB2E4.\r\n */\r\nfunction tryBuildSimpleAncestorCss(element, baseSelector, contextElement) {\r\n  if (!element || !baseSelector) return null;\r\n  const base = baseSelector.startsWith('css=') ? baseSelector.slice(4).trim() : baseSelector.trim();\r\n  if (!base) return null;\r\n  const scopedPrefix = contextElement ? ':scope ' : '';\r\n  const targetScope = contextElement || document;\r\n  let current = element;\r\n  let selector = base;\r\n  let depth = 0;\r\n\r\n  const buildParentSelector = (node) => {\r\n    if (!node || node.nodeType !== 1) return null;\r\n    if (node.id) {\r\n      return `#${cssEscapeIdent(node.id)}`;\r\n    }\r\n    const classList = Array.from(node.classList || []).filter(Boolean);\r\n    if (classList.length) {\r\n      return `.${cssEscapeIdent(classList[0])}`;\r\n    }\r\n    return node.tagName ? node.tagName.toLowerCase() : null;\r\n  };\r\n\r\n  while (current && depth < CSS_SIMPLE_PARENT_MAX_DEPTH) {\r\n    const fullSelector = contextElement ? `css=${scopedPrefix}${selector}` : `css=${selector}`;\r\n    const parsed = parseSelectorForMatching(fullSelector, 'css');\r\n    const count = countMatchesForSelector(parsed, targetScope);\r\n    // \uD604\uC7AC\uAE4C\uC9C0\uC758 \uC870\uD569\uC774 \uC720\uC77C\uD574\uC84C\uC73C\uBA74 \uC989\uC2DC \uBC18\uD658.\r\n    if (count === 1) {\r\n      return { selector: fullSelector, count };\r\n    }\r\n    const parent = current.parentElement;\r\n    // \uBD80\uBAA8 \uC694\uC18C\uAC00 \uB354 \uC774\uC0C1 \uC5C6\uC73C\uBA74 \uC885\uB8CC.\r\n    if (!parent) break;\r\n    const parentSelector = buildParentSelector(parent);\r\n    // \uBD80\uBAA8\uC5D0 \uC0AC\uC6A9\uD560 \uC2DD\uBCC4\uC790\uAC00 \uC5C6\uC73C\uBA74 \uB354 \uC774\uC0C1 \uD655\uC7A5\uD560 \uC218 \uC5C6\uB2E4.\r\n    if (!parentSelector) break;\r\n    selector = `${parentSelector} > ${selector}`;\r\n    current = parent;\r\n    depth += 1;\r\n  }\r\n\r\n  const finalSelector = contextElement ? `css=${scopedPrefix}${selector}` : `css=${selector}`;\r\n  const finalParsed = parseSelectorForMatching(finalSelector, 'css');\r\n  const finalCount = countMatchesForSelector(finalParsed, targetScope);\r\n  // \uB9C8\uC9C0\uB9C9 \uC870\uD569\uC774 \uC720\uC77C\uD574\uC84C\uB294\uC9C0 \uAC80\uC0AC\uD55C\uB2E4.\r\n  if (finalCount === 1) {\r\n    return { selector: finalSelector, count: finalCount };\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * \uCCAB \uBC88\uC9F8 nth-of-type \uC694\uC18C\uC5D0 \uB300\uD55C CSS \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nfunction buildFirstNthOfTypeSelector(element) {\r\n  if (!element || element.nodeType !== 1) return null;\r\n  const parent = element.parentElement;\r\n  if (!parent) return null;\r\n  const tagName = element.tagName ? element.tagName.toLowerCase() : null;\r\n  if (!tagName) return null;\r\n  const siblings = Array.from(parent.children || []);\r\n  let nth = 0;\r\n  for (const sibling of siblings) {\r\n    if (!sibling || sibling.nodeType !== 1) continue;\r\n    if (!sibling.tagName) continue;\r\n    // \uB3D9\uC77C \uD0DC\uADF8\uC778 \uD615\uC81C \uC694\uC18C\uB97C \uCE74\uC6B4\uD2B8\uD574 \uCCAB \uBC88\uC9F8\uC778\uC9C0 \uD655\uC778.\r\n    if (sibling.tagName.toLowerCase() === tagName) {\r\n      nth += 1;\r\n      if (sibling === element) break;\r\n    }\r\n  }\r\n  if (nth !== 1) return null;\r\n  const classList = Array.from(element.classList || []).filter(Boolean);\r\n  if (!classList.length) return null;\r\n  const escapedClasses = classList.slice(0, 2).map((cls) => cssEscapeIdent(cls)).filter(Boolean);\r\n  if (!escapedClasses.length) return null;\r\n  const selector = `${tagName}.${escapedClasses.join('.')}:nth-of-type(1)`;\r\n  const scopedResult = tryBuildSimpleAncestorCss(element, selector, null);\r\n  if (scopedResult && scopedResult.count === 1) {\r\n    return {\r\n      type: 'css',\r\n      selector: scopedResult.selector,\r\n      score: 88,\r\n      reason: '\uCCAB \uBC88\uC9F8 \uD56D\uBAA9 (nth-of-type)'\r\n    };\r\n  }\r\n  const parsed = parseSelectorForMatching(`css=${selector}`, 'css');\r\n  const count = countMatchesForSelector(parsed, document);\r\n  if (count === 1) {\r\n    return {\r\n      type: 'css',\r\n      selector: `css=${selector}`,\r\n      score: 84,\r\n      reason: '\uCCAB \uBC88\uC9F8 \uD56D\uBAA9 (nth-of-type)'\r\n    };\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * \uB300\uC0C1 \uC694\uC18C\uAC00 iframe \uB0B4\uBD80\uC5D0 \uC788\uB294 \uACBD\uC6B0 iframe \uC815\uBCF4\uB97C \uBC18\uD658\uD55C\uB2E4.\r\n */\r\nexport function getIframeContext(target) {\r\n  try {\r\n    const win = target && target.ownerDocument && target.ownerDocument.defaultView;\r\n    if (!win) return null;\r\n    const frameEl = win.frameElement || null;\r\n    if (!frameEl) return null;\r\n    return {\r\n      id: frameEl.id || null,\r\n      name: frameEl.name || null,\r\n      src: frameEl.src || (frameEl.getAttribute && frameEl.getAttribute('src')) || null\r\n    };\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * \uD6C4\uBCF4 \uC140\uB809\uD130\uC758 \uC720\uC77C\uC131 \uAC80\uC0AC\uB97C \uC218\uD589\uD558\uACE0 \uD544\uC694\uD55C \uACBD\uC6B0 \uBCF4\uC815\uD55C\uB2E4.\r\n */\r\nfunction enrichCandidateWithUniqueness(baseCandidate, options = {}) {\r\n  if (!baseCandidate || !baseCandidate.selector) return null;\r\n  const candidate = { ...baseCandidate };\r\n  const originalType = candidate.type || inferSelectorType(candidate.selector);\r\n  const resolvedType = candidate.type || originalType;\r\n  const parsed = parseSelectorForMatching(candidate.selector, resolvedType);\r\n  let reasonParts = candidate.reason ? [candidate.reason] : [];\r\n\r\n  if (!options.skipGlobalCheck) {\r\n  const matchOptions = {\r\n    matchMode: candidate.matchMode,\r\n    maxCount: typeof options.maxMatchSample === 'number' && options.maxMatchSample > 0\r\n      ? options.maxMatchSample\r\n      : 4\r\n  };\r\n    // \uBB38\uC11C \uC804\uCCB4\uB97C \uB300\uC0C1\uC73C\uB85C \uB9E4\uCE6D \uD69F\uC218\uB97C \uACC4\uC0B0\uD55C\uB2E4.\r\n    const globalCount = countMatchesForSelector(parsed, document, matchOptions);\r\n    candidate.matchCount = globalCount;\r\n    candidate.unique = globalCount === 1;\r\n    // \uC720\uC77C\uD558\uC9C0 \uC54A\uC740\uB370 \uD5C8\uC6A9\uB418\uC9C0 \uC54A\uC73C\uBA74 \uD6C4\uBCF4\uB97C \uBC84\uB9B0\uB2E4.\r\n    if (globalCount === 0 && options.allowZero !== true) {\r\n      return null;\r\n    }\r\n    reasonParts = reasonParts.filter((part) => !/\uC720\uC77C \uC77C\uCE58|\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58/.test(part));\r\n    if (globalCount === 1) {\r\n      reasonParts.push('\uC720\uC77C \uC77C\uCE58');\r\n    } else if (globalCount > 1) {\r\n      reasonParts.push(globalCount === 2 ? '2\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58 (\uCD94\uAC00 \uC870\uD569)' : `${globalCount}\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58`);\r\n    }\r\n  }\r\n\r\n  if (options.contextElement) {\r\n    // \uD2B9\uC815 \uCEE8\uD14D\uC2A4\uD2B8 \uB0B4\uC5D0\uC11C\uC758 \uB9E4\uCE6D \uAC1C\uC218\uB97C \uBCC4\uB3C4\uB85C \uACC4\uC0B0\uD55C\uB2E4.\r\n    const contextCount = countMatchesForSelector(parsed, options.contextElement, { matchMode: candidate.matchMode });\r\n    candidate.contextMatchCount = contextCount;\r\n    candidate.uniqueInContext = contextCount === 1;\r\n    if (options.contextLabel) {\r\n      if (contextCount === 1) {\r\n        reasonParts.push(`${options.contextLabel} \uB0B4 \uC720\uC77C`);\r\n      } else if (contextCount > 1) {\r\n        reasonParts.push(`${options.contextLabel} \uB0B4 ${contextCount}\uAC1C \uC77C\uCE58`);\r\n      } else {\r\n        reasonParts.push(`${options.contextLabel} \uB0B4 \uC77C\uCE58 \uC5C6\uC74C`);\r\n      }\r\n    }\r\n    if (options.requireContextUnique && !candidate.uniqueInContext) {\r\n      return null;\r\n    }\r\n    if (options.skipGlobalCheck) {\r\n      // \uC804\uC5ED \uCCB4\uD06C\uB97C \uC0DD\uB7B5\uD55C \uACBD\uC6B0 \uCEE8\uD14D\uC2A4\uD2B8 \uACB0\uACFC\uB97C \uADF8\uB300\uB85C \uC0AC\uC6A9\uD55C\uB2E4.\r\n      candidate.matchCount = contextCount;\r\n      candidate.unique = candidate.uniqueInContext;\r\n    }\r\n  }\r\n\r\n  if (!options.skipGlobalCheck && options.requireUnique && candidate.unique === false) {\r\n    return null;\r\n  }\r\n\r\n  if (!options.skipGlobalCheck && candidate.unique === false && typeof candidate.score === 'number') {\r\n    candidate.score = Math.min(candidate.score, options.duplicateScore ?? 55);\r\n  }\r\n\r\n  if (!options.skipGlobalCheck && candidate.unique === false && typeof candidate.score === 'number') {\r\n    candidate.score = Math.min(candidate.score, options.duplicateScore ?? 60);\r\n  }\r\n\r\n  if (!candidate.unique && originalType === 'text' && options.element && (candidate.textValue || parsed.value)) {\r\n    const ancestorResult = tryBuildAncestorTextXPath(\r\n      options.element,\r\n      candidate.textValue || parsed.value,\r\n      candidate.matchMode || 'exact'\r\n    );\r\n    if (ancestorResult) {\r\n      candidate.selector = ancestorResult.selector;\r\n      candidate.type = 'xpath';\r\n      candidate.relation = candidate.relation || 'global';\r\n      if (ancestorResult.reason) {\r\n        reasonParts.push(ancestorResult.reason);\r\n      } else {\r\n        reasonParts.push('\uD14D\uC2A4\uD2B8 \uC870\uD569');\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!candidate.unique && options.element) {\r\n    const baseCssSelector = extractCssSelector(candidate);\r\n    if (baseCssSelector) {\r\n      const simpleDerived = tryBuildSimpleAncestorCss(options.element, baseCssSelector, options.contextElement);\r\n      if (simpleDerived) {\r\n        candidate.selector = simpleDerived.selector;\r\n        candidate.type = 'css';\r\n        candidate.relation = options.contextElement ? 'relative' : candidate.relation || 'global';\r\n        reasonParts.push('\uBD80\uBAA8 \uD0DC\uADF8 \uACBD\uB85C \uC870\uD569');\r\n      } else {\r\n        const derived = tryBuildAncestorCssSelector(options.element, baseCssSelector, options.contextElement);\r\n        if (derived) {\r\n          candidate.selector = derived.selector;\r\n          candidate.type = 'css';\r\n          candidate.relation = options.contextElement ? 'relative' : candidate.relation || 'global';\r\n          reasonParts.push('\uC0C1\uC704 class \uACBD\uB85C \uC870\uD569');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (originalType !== 'text' && originalType !== 'xpath' && !candidate.unique && options.element && options.enableIndexing !== false) {\r\n    const contextEl = options.contextElement && candidate.relation === 'relative' ? options.contextElement : null;\r\n    const uniqueSelector = buildUniqueCssPath(options.element, contextEl);\r\n    if (uniqueSelector && uniqueSelector !== candidate.selector) {\r\n      const uniqueParsed = parseSelectorForMatching(uniqueSelector, 'css');\r\n      const count = countMatchesForSelector(uniqueParsed, contextEl || document, { matchMode: candidate.matchMode, maxCount: 2 });\r\n      if (count === 1) {\r\n        candidate.selector = uniqueSelector;\r\n        candidate.type = 'css';\r\n        candidate.relation = contextEl ? 'relative' : candidate.relation;\r\n        reasonParts.push('\uACBD\uB85C \uC778\uB371\uC2F1 \uC801\uC6A9');\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!candidate.unique) {\r\n    const verificationParsed = parseSelectorForMatching(candidate.selector, candidate.type || inferSelectorType(candidate.selector));\r\n    const verificationCount = countMatchesForSelector(\r\n      verificationParsed,\r\n      options.contextElement || document,\r\n      { matchMode: candidate.matchMode, maxCount: 4 }\r\n    );\r\n    candidate.matchCount = verificationCount;\r\n    candidate.unique = verificationCount === 1;\r\n    candidate.uniqueInContext = verificationCount === 1;\r\n    reasonParts = reasonParts.filter((part) => !/\uC720\uC77C \uC77C\uCE58|\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58/.test(part));\r\n    if (verificationCount === 1) {\r\n      reasonParts.push('\uC720\uC77C \uC77C\uCE58');\r\n    } else if (verificationCount === 2) {\r\n      reasonParts.push('2\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58 (\uCD94\uAC00 \uC870\uD569)');\r\n    } else if (verificationCount > 2) {\r\n      reasonParts.push(`${verificationCount}\uAC1C \uC694\uC18C\uC640 \uC77C\uCE58`);\r\n    }\r\n  }\r\n\r\n  candidate.reason = reasonParts.join(' \u2022 ');\r\n  if (typeof candidate.score === 'number') {\r\n    if (candidate.unique) {\r\n      candidate.score = Math.min(100, Math.max(candidate.score + UNIQUE_MATCH_BONUS, 95));\r\n    } else if (candidate.matchCount > 1) {\r\n      candidate.score = Math.max(\r\n        10,\r\n        candidate.score - Math.min(24, (candidate.matchCount - 1) * DUPLICATE_PENALTY_STEP)\r\n      );\r\n    }\r\n  }\r\n  return applyFragilityAdjustments(candidate);\r\n}\r\n\r\n/**\r\n * \uC911\uBCF5 \uD6C4\uBCF4\uB97C \uC81C\uAC70\uD558\uBA74\uC11C \uD6C4\uBCF4 \uBAA9\uB85D\uC744 \uCD95\uC801\uD558\uB294 \uAC04\uB2E8\uD55C \uB808\uC9C0\uC2A4\uD2B8\uB9AC\uB97C \uB9CC\uB4E0\uB2E4.\r\n */\r\nfunction createCandidateRegistry() {\r\n  const results = [];\r\n  const seen = new Set();\r\n  return {\r\n    add(candidate) {\r\n      if (!candidate || !candidate.selector) return;\r\n      const type = candidate.type || inferSelectorType(candidate.selector);\r\n      const key = `${type || ''}::${candidate.selector}`;\r\n      if (seen.has(key)) return;\r\n      seen.add(key);\r\n      results.push(candidate);\r\n    },\r\n    list() {\r\n      return results;\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * nth-of-type, \uC808\uB300 XPath \uB4F1 \uCDE8\uC57D \uD328\uD134\uC744 \uAC10\uC9C0\uD574 \uC810\uC218\uB97C \uD398\uB110\uD2F0\uD55C\uB2E4.\r\n */\r\nfunction applyFragilityAdjustments(candidate) {\r\n  if (!candidate || typeof candidate.score !== 'number') {\r\n    return candidate;\r\n  }\r\n  const selector = candidate.selector || '';\r\n  const inferredType = candidate.type || inferSelectorType(selector);\r\n  let penalty = 0;\r\n  const flags = [];\r\n\r\n  if (inferredType === 'xpath-full' || /xpath=\\/html/i.test(selector)) {\r\n    // \uC808\uB300 XPath\uB294 \uC27D\uAC8C \uAE68\uC9C0\uBBC0\uB85C \uD070 \uD398\uB110\uD2F0\uB97C \uBD80\uC5EC.\r\n    penalty += 18;\r\n    flags.push('\uC808\uB300 XPath');\r\n  } else if ((inferredType === 'xpath' || inferredType === 'xpath-full') && /\\/\\d+\\]/.test(selector) && !/@/.test(selector)) {\r\n    // \uAD6C\uC870 \uC758\uC874 XPath(\uC778\uB371\uC2A4 \uAE30\uBC18)\uB294 \uC911\uAC04 \uD398\uB110\uD2F0.\r\n    penalty += 8;\r\n    flags.push('\uAD6C\uC870 \uC758\uC874 XPath');\r\n  }\r\n\r\n  if ((inferredType === 'css' || inferredType === 'class' || inferredType === 'class-tag' || inferredType === 'id') && /:nth-(child|of-type)\\(/i.test(selector)) {\r\n    const match = selector.match(/:nth-(?:child|of-type)\\((\\d+)\\)/i);\r\n    const nthValue = match ? parseInt(match[1], 10) : null;\r\n    // nth-of-type \uC0AC\uC6A9 \uC2DC \uC704\uCE58 \uC758\uC874\uC131\uC774 \uC788\uC73C\uBBC0\uB85C \uD398\uB110\uD2F0.\r\n    penalty += nthValue === 1 ? 2 : 6;\r\n    flags.push('nth-of-type \uC0AC\uC6A9');\r\n  }\r\n\r\n  if (inferredType === 'class' || inferredType === 'class-tag') {\r\n    const classCount = (selector.match(/\\./g) || []).length;\r\n    if (classCount > 2) {\r\n      // \uD074\uB798\uC2A4\uAC00 \uB108\uBB34 \uB9CE\uC73C\uBA74 \uC720\uC9C0\uBCF4\uC218\uAC00 \uC5B4\uB835\uAE30\uC5D0 \uD398\uB110\uD2F0.\r\n      penalty += (classCount - 2) * 4;\r\n      flags.push('\uACFC\uB3C4\uD55C class \uC870\uD569');\r\n    }\r\n  }\r\n\r\n  if (penalty > 0) {\r\n    candidate.score = Math.max(5, candidate.score - penalty);\r\n    if (flags.length) {\r\n      const fragility = `\uCDE8\uC57D \uC694\uC18C (${flags.join(', ')})`;\r\n      candidate.reason = candidate.reason ? `${candidate.reason} \u2022 ${fragility}` : fragility;\r\n    }\r\n  }\r\n  return candidate;\r\n}\r\n\r\n/**\r\n * \uD6C4\uBCF4\uB97C \uC720\uC77C\uC131 \uAC80\uC99D \uD6C4 \uB808\uC9C0\uC2A4\uD2B8\uB9AC\uC5D0 \uCD94\uAC00\uD55C\uB2E4.\r\n */\r\nfunction addCandidate(registry, candidate, options = {}) {\r\n  const enriched = enrichCandidateWithUniqueness(candidate, options);\r\n  if (enriched) {\r\n    registry.add(enriched);\r\n  }\r\n}\r\n\r\n/**\r\n * \uB2E8\uC77C \uC694\uC18C\uC5D0\uC11C \uC0AC\uC6A9\uD560 \uB9CC\uD55C \uBAA8\uB4E0 \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uC218\uC9D1\uD55C\uB2E4.\r\n */\r\nexport function getSelectorCandidates(element) {\r\n  if (!element) return [];\r\n  const registry = createCandidateRegistry();\r\n\r\n  try {\r\n    // \uC6B0\uC120 \uC18D\uC131 \uAE30\uBC18 \uD6C4\uBCF4\uB97C \uCD94\uAC00.\r\n    buildAttributeSelectors(element).forEach((cand) => {\r\n      addCandidate(registry, cand, { duplicateScore: 62, element, maxMatchSample: 5 });\r\n    });\r\n  } catch (e) {\r\n    // ignore attribute access errors\r\n  }\r\n\r\n  // class \uC870\uD569 \uAE30\uBC18 \uD6C4\uBCF4.\r\n  generateClassSelectors(element).forEach((cand) => {\r\n    addCandidate(registry, cand, { duplicateScore: 58, element, maxMatchSample: 5 });\r\n  });\r\n\r\n  const rawText = (element.innerText || element.textContent || '').trim().split('\\n').map((t) => t.trim()).filter(Boolean)[0];\r\n  if (rawText) {\r\n    const truncatedText = rawText.slice(0, 60);\r\n    const textCandidate = enrichCandidateWithUniqueness(\r\n      { type: 'text', selector: `text=\"${escapeAttributeValue(truncatedText)}\"`, score: DEFAULT_TEXT_SCORE, reason: '\uD14D\uC2A4\uD2B8 \uC77C\uCE58', textValue: truncatedText },\r\n      { duplicateScore: 55, element }\r\n    );\r\n    if (textCandidate) {\r\n      textCandidate.matchMode = textCandidate.matchMode || 'exact';\r\n      registry.add(textCandidate);\r\n    }\r\n  }\r\n\r\n  const robustXPath = buildRobustXPath(element);\r\n  if (robustXPath) {\r\n    addCandidate(\r\n      registry,\r\n      { type: 'xpath', selector: `xpath=${robustXPath}`, score: 58, reason: '\uC18D\uC131 \uAE30\uBC18 XPath', xpathValue: robustXPath },\r\n      { duplicateScore: 52, element, maxMatchSample: 5 }\r\n    );\r\n  }\r\n\r\n  const fullXPath = buildFullXPath(element);\r\n  if (fullXPath) {\r\n    addCandidate(\r\n      registry,\r\n      { type: 'xpath-full', selector: `xpath=${fullXPath}`, score: 42, reason: 'Full XPath (\uC808\uB300 \uACBD\uB85C)', xpathValue: fullXPath },\r\n      { duplicateScore: 36, element, enableIndexing: false, maxMatchSample: 5 }\r\n    );\r\n  }\r\n\r\n  addCandidate(\r\n    registry,\r\n    { type: 'tag', selector: element.tagName.toLowerCase(), score: DEFAULT_TAG_SCORE, reason: '\uD0DC\uADF8 \uC774\uB984' },\r\n    { duplicateScore: 28, allowZero: true, element, maxMatchSample: 5 }\r\n  );\r\n\r\n  const firstNthCandidate = buildFirstNthOfTypeSelector(element);\r\n  if (firstNthCandidate) {\r\n    addCandidate(registry, firstNthCandidate, { duplicateScore: 66, element });\r\n  }\r\n\r\n  return sortCandidates(registry.list());\r\n}\r\n\r\n/**\r\n * \uBD80\uBAA8/\uC790\uC2DD \uAD00\uACC4\uB97C \uACE0\uB824\uD55C \uC0C1\uB300 \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nexport function getChildSelectorCandidates(parent, child) {\r\n  if (!parent || !child) return [];\r\n  const registry = createCandidateRegistry();\r\n\r\n  const relativeCss = buildRelativeCssSelector(parent, child);\r\n  if (relativeCss) {\r\n    addCandidate(\r\n      registry,\r\n      { type: 'css', selector: `css=${relativeCss}`, score: 90, reason: '\uBD80\uBAA8 \uAE30\uC900 CSS \uACBD\uB85C', relation: 'relative' },\r\n      { skipGlobalCheck: true, contextElement: parent, contextLabel: '\uBD80\uBAA8', duplicateScore: 68, element: child }\r\n    );\r\n  }\r\n\r\n  const relativeXPath = buildRelativeXPathSelector(parent, child);\r\n  if (relativeXPath) {\r\n    addCandidate(\r\n      registry,\r\n      { type: 'xpath', selector: `xpath=${relativeXPath}`, score: 86, reason: '\uBD80\uBAA8 \uAE30\uC900 XPath \uACBD\uB85C', relation: 'relative', xpathValue: relativeXPath },\r\n      { skipGlobalCheck: true, contextElement: parent, contextLabel: '\uBD80\uBAA8', duplicateScore: 66, element: child }\r\n    );\r\n  }\r\n\r\n  // \uC790\uC2DD \uC694\uC18C \uC790\uCCB4\uC758 \uD6C4\uBCF4\uB3C4 \uD568\uAED8 \uD3EC\uD568\uD574 \uBE44\uAD50\uD560 \uC218 \uC788\uAC8C \uD55C\uB2E4.\r\n  (getSelectorCandidates(child) || []).forEach((cand) => {\r\n    registry.add({ ...cand, relation: cand.relation || 'global' });\r\n  });\r\n\r\n  return sortCandidates(registry.list());\r\n}\r\n\r\n/**\r\n * \uD604\uC7AC \uC694\uC18C\uC5D0\uC11C \uBD80\uBAA8 \uC694\uC18C\uB97C \uAC00\uB9AC\uD0AC \uC218 \uC788\uB294 \uC0C1\uB300 \uC140\uB809\uD130 \uD6C4\uBCF4\uB97C \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nexport function getParentSelectorCandidates(child, parent) {\r\n  if (!child || !parent) return [];\r\n  const registry = createCandidateRegistry();\r\n\r\n  let current = parent;\r\n  let depth = 1;\r\n  // \uBD80\uBAA8 \uCCB4\uC778\uC744 \uB530\uB77C \uC62C\uB77C\uAC00\uBA74\uC11C ../ \uACBD\uB85C\uB97C \uC0DD\uC131.\r\n  while (current && current.nodeType === 1) {\r\n    const steps = Array(depth).fill('..').join('/');\r\n    addCandidate(\r\n      registry,\r\n      {\r\n        type: 'xpath',\r\n        selector: `xpath=${steps}`,\r\n        score: Math.max(72, 86 - (depth - 1) * 5),\r\n        reason: depth === 1 ? '\uC9C1\uC811 \uC0C1\uC704 \uC694\uC18C' : `${depth}\uB2E8\uACC4 \uC0C1\uC704 \uC694\uC18C`,\r\n        relation: 'relative',\r\n        xpathValue: steps\r\n      },\r\n      { skipGlobalCheck: true, contextElement: child, contextLabel: '\uD604\uC7AC \uC694\uC18C', duplicateScore: Math.max(58, 68 - (depth - 1) * 5), element: current }\r\n    );\r\n    if (!current.parentElement || current === document.documentElement) {\r\n      // \uB354 \uC774\uC0C1 \uC0C1\uC704 \uC694\uC18C\uAC00 \uC5C6\uC73C\uBA74 \uBC18\uBCF5\uC744 \uC885\uB8CC.\r\n      break;\r\n    }\r\n    current = current.parentElement;\r\n    depth += 1;\r\n  }\r\n\r\n  // \uBD80\uBAA8 \uC694\uC18C \uC790\uCCB4\uC758 \uC804\uC5ED \uD6C4\uBCF4\uB3C4 \uD568\uAED8 \uCD94\uAC00\uD55C\uB2E4.\r\n  (getSelectorCandidates(parent) || []).forEach((cand) => {\r\n    registry.add({ ...cand, relation: cand.relation || 'global' });\r\n  });\r\n\r\n  return sortCandidates(registry.list());\r\n}\r\n\r\n/**\r\n * \uC774\uBCA4\uD2B8 \uB808\uCF54\uB4DC\uC5D0\uC11C \uC140\uB809\uD130 \uC815\uBCF4\uB97C \uCD94\uCD9C\uD574 \uBC30\uC5F4 \uD615\uD0DC\uB85C \uB9CC\uB4E0\uB2E4.\r\n */\r\nexport function collectSelectorInfos(eventRecord) {\r\n  const infos = [];\r\n  const seen = new Set();\r\n\r\n  function pushInfo(selector, type, extra = {}) {\r\n    if (!selector) return;\r\n    const key = `${selector}::${type || ''}`;\r\n    if (seen.has(key)) return;\r\n    seen.add(key);\r\n    infos.push({\r\n      selector,\r\n      type: type || inferSelectorType(selector),\r\n      score: extra.score || 0,\r\n      textValue: extra.textValue || null,\r\n      xpathValue: extra.xpathValue || null,\r\n      matchMode: extra.matchMode || null\r\n    });\r\n  }\r\n\r\n  if (eventRecord && eventRecord.primarySelector) {\r\n    pushInfo(eventRecord.primarySelector, eventRecord.primarySelectorType || inferSelectorType(eventRecord.primarySelector), {\r\n      score: 100,\r\n      textValue: eventRecord.primarySelectorText || null,\r\n      xpathValue: eventRecord.primarySelectorXPath || null,\r\n      matchMode: eventRecord.primarySelectorMatchMode || null\r\n    });\r\n  }\r\n\r\n  if (eventRecord && Array.isArray(eventRecord.selectorCandidates)) {\r\n    [...eventRecord.selectorCandidates]\r\n      .sort((a, b) => (b.score || 0) - (a.score || 0))\r\n      .forEach((candidate) => {\r\n        if (!candidate || !candidate.selector) return;\r\n        // \uD6C4\uBCF4 \uC140\uB809\uD130\uB294 \uC810\uC218 \uC21C\uC73C\uB85C \uC815\uB82C\uD574 \uC6B0\uC120\uC21C\uC704\uB97C \uC720\uC9C0\uD55C\uB2E4.\r\n        pushInfo(candidate.selector, candidate.type || inferSelectorType(candidate.selector), {\r\n          score: candidate.score || 0,\r\n          textValue: candidate.textValue || null,\r\n          xpathValue: candidate.xpathValue || null,\r\n          matchMode: candidate.matchMode || null\r\n        });\r\n      });\r\n  }\r\n\r\n  if (eventRecord && eventRecord.tag) {\r\n    pushInfo(eventRecord.tag.toLowerCase(), 'tag', { score: 1 });\r\n  }\r\n\r\n  return infos;\r\n}\r\n\r\n", "/**\r\n * \uB2E4\uC591\uD55C \uC140\uB809\uD130 \uC815\uBCF4\uB97C \uBC14\uD0D5\uC73C\uB85C \uC2E4\uC81C DOM \uC694\uC18C\uB97C \uCC3E\uB294 \uD5EC\uD37C.\r\n * \uB9AC\uD50C\uB808\uC774 \uBC0F \uC694\uC18C \uC120\uD0DD \uC6CC\uD06C\uD50C\uB85C\uC6B0\uC5D0\uC11C \uC7AC\uC0AC\uC6A9\uB41C\uB2E4.\r\n */\r\nimport { collectSelectorInfos } from '../selectors/index.js';\r\nimport { normalizeText, parseSelectorForMatching } from '../utils/dom.js';\r\n\r\n/**\r\n * \uC140\uB809\uD130 \uBB38\uC790\uC5F4 \uD55C \uAC1C\uB97C \uBC1B\uC544 DOM \uC694\uC18C\uB97C \uC9C1\uC811 \uCC3E\uB294\uB2E4.\r\n * XPath/text/CSS \uD3EC\uB9F7\uC744 \uBAA8\uB450 \uC9C0\uC6D0\uD55C\uB2E4.\r\n */\r\nfunction findElementBySelector(selector) {\r\n  if (!selector) return null;\r\n  try {\r\n    if (selector.startsWith('xpath=')) {\r\n      // \uD655\uC7A5\uC790\uAC00 \uBD99\uC5B4 \uC788\uC73C\uBA74 \uC55E\uBD80\uBD84\uC744 \uC81C\uAC70\uD558\uACE0 XPath\uB85C \uD3C9\uAC00.\r\n      const expression = selector.slice(6);\r\n      return document.evaluate(expression, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue || null;\r\n    }\r\n    if (selector.startsWith('//') || selector.startsWith('(')) {\r\n      // xpath= \uC811\uB450\uC0AC\uAC00 \uC5C6\uC5B4\uB3C4 // \uD639\uC740 ( \uC73C\uB85C \uC2DC\uC791\uD558\uBA74 XPath\uB85C \uAC04\uC8FC\uD55C\uB2E4.\r\n      return document.evaluate(selector, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue || null;\r\n    }\r\n    if (selector.startsWith('text=\"') || selector.startsWith(\"text='\")) {\r\n      // text= \uC811\uB450\uC0AC\uB294 \uC21C\uC218 \uBB38\uC790\uC5F4 \uBE44\uAD50\uC774\uBBC0\uB85C \uBAA8\uB4E0 \uC694\uC18C\uB97C \uC21C\uD68C\uD574 \uC77C\uCE58 \uC5EC\uBD80\uB97C \uD655\uC778.\r\n      const textLiteral = selector.replace(/^text=/, '');\r\n      const trimmed = textLiteral.replace(/^['\"]|['\"]$/g, '');\r\n      const decoded = trimmed.replace(/\\\\\"/g, '\"');\r\n      return Array.from(document.querySelectorAll('*')).find((el) => (el.innerText || '').trim().includes(decoded));\r\n    }\r\n    return document.querySelector(selector);\r\n  } catch (err) {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * selector \uC815\uBCF4 \uAC1D\uCCB4\uC640 scope\uB97C \uBC1B\uC544 \uC0C1\uB300/\uC808\uB300 \uC5EC\uBD80\uC5D0 \uB530\uB77C \uC694\uC18C\uB97C \uCC3E\uB294\uB2E4.\r\n * @param {{selector: string, type?: string, relation?: string, matchMode?: string}} info\r\n * @param {Element|Document} scope\r\n */\r\nfunction findElementInScope(info, scope) {\r\n  if (!info || !info.selector) return null;\r\n  const selector = info.selector;\r\n  const type = info.type || parseSelectorForMatching(selector).type;\r\n  const isRelative = info.relation === 'relative';\r\n  const currentScope = scope && scope.nodeType === 1 ? scope : document;\r\n\r\n  const runGlobal = () => findElementBySelector(selector);\r\n\r\n  try {\r\n    if (isRelative && currentScope !== document) {\r\n      if (type === 'xpath' || selector.startsWith('xpath=')) {\r\n        // \uC0C1\uB300 XPath: \uD604\uC7AC scope\uB97C context node\uB85C \uB450\uACE0 \uD3C9\uAC00\uD55C\uB2E4.\r\n        const expression = selector.startsWith('xpath=') ? selector.slice(6) : selector;\r\n        const doc = currentScope.ownerDocument || document;\r\n        const res = doc.evaluate(expression, currentScope, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\r\n        return res.singleNodeValue || null;\r\n      }\r\n      if (type === 'text' || selector.startsWith('text=')) {\r\n        const raw = selector.replace(/^text=/, '');\r\n        const trimmed = raw.replace(/^['\"]|['\"]$/g, '');\r\n        const targetText = normalizeText(trimmed);\r\n        const matchMode = info.matchMode || 'contains';\r\n        if (!targetText) return null;\r\n        const elements = currentScope.querySelectorAll('*');\r\n        for (const el of elements) {\r\n          // \uBAA8\uB4E0 \uD6C4\uBCF4 \uC694\uC18C\uC758 \uC815\uADDC\uD654\uB41C \uD14D\uC2A4\uD2B8\uB97C \uBE44\uAD50\uD55C\uB2E4.\r\n          const txt = normalizeText(el.innerText || el.textContent || '');\r\n          if (!txt) continue;\r\n          if (matchMode === 'exact' ? txt === targetText : txt.includes(targetText)) {\r\n            return el;\r\n          }\r\n        }\r\n        return null;\r\n      }\r\n      let css = selector;\r\n      if (css.startsWith('css=')) {\r\n        css = css.slice(4);\r\n      }\r\n      // \uC0C1\uB300 CSS\uB294 currentScope \uB0B4\uBD80\uC5D0\uC11C querySelector\uB97C \uC2E4\uD589.\r\n      return currentScope.querySelector(css);\r\n    }\r\n    // relative\uAC00 \uC544\uB2C8\uBA74 \uC804\uC5ED DOM\uC5D0\uC11C \uCC3E\uB294\uB2E4.\r\n    return runGlobal();\r\n  } catch (err) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function findElementByPath(path) {\r\n  if (!Array.isArray(path) || path.length === 0) return null;\r\n  let currentElement = null;\r\n  let currentScope = document;\r\n  for (const entry of path) {\r\n    // relative\uB294 \uC9C1\uC804 \uC694\uC18C\uB97C scope\uB85C \uC0BC\uACE0, \uC544\uB2C8\uBA74 \uC804\uC5ED\uC73C\uB85C \uB9AC\uC14B\uD55C\uB2E4.\r\n    const scope = entry.relation === 'relative' ? currentElement || currentScope : document;\r\n    const el = findElementInScope(entry, scope);\r\n    if (!el) return null;\r\n    currentElement = el;\r\n    currentScope = el;\r\n  }\r\n  return currentElement;\r\n}\r\n\r\nexport function findElementWithInfo(info) {\r\n  if (!info || !info.selector) return null;\r\n  const type = info.type || parseSelectorForMatching(info.selector).type;\r\n  if (type === 'text') {\r\n    const targetText = normalizeText(info.textValue) || null;\r\n    if (targetText) {\r\n      const matchMode = info.matchMode || 'contains';\r\n      // \uD14D\uC2A4\uD2B8 \uAE30\uBC18 \uD6C4\uBCF4\uB294 \uC804\uCCB4 DOM\uC744 \uC21C\uD68C\uD558\uBA70 \uC77C\uCE58 \uD14D\uC2A4\uD2B8\uB97C \uCC3E\uB294\uB2E4.\r\n      const match = Array.from(document.querySelectorAll('*')).find((el) => {\r\n        const elText = normalizeText(el.innerText || el.textContent || '');\r\n        if (!elText) return false;\r\n        return matchMode === 'exact' ? elText === targetText : elText.includes(targetText);\r\n      });\r\n      if (match) return match;\r\n    }\r\n  }\r\n  if (type === 'xpath') {\r\n    const expression = info.xpathValue || info.selector.replace(/^xpath=/, '');\r\n    if (expression) {\r\n      try {\r\n        // XPath\uB294 \uC2E4\uD328\uD574\uB3C4 throw\uAC00 \uB0A0 \uC218 \uC788\uC73C\uB2C8 try/catch\uB85C \uAC10\uC2FC\uB2E4.\r\n        const res = document.evaluate(expression, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\r\n        if (res.singleNodeValue) return res.singleNodeValue;\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    }\r\n  }\r\n  return findElementBySelector(info.selector);\r\n}\r\n\r\nexport async function locateElementForEvent(eventRecord, timeoutMs = 5000) {\r\n  const infos = collectSelectorInfos(eventRecord);\r\n  if (infos.length === 0) {\r\n    return { element: null, info: null };\r\n  }\r\n  const start = performance.now();\r\n  const retryInterval = 200;\r\n  while (performance.now() - start < timeoutMs) {\r\n    // \uD6C4\uBCF4 \uC140\uB809\uD130 \uB9AC\uC2A4\uD2B8\uB97C \uC21C\uC11C\uB300\uB85C \uC2DC\uB3C4\uD55C\uB2E4.\r\n    for (const info of infos) {\r\n      const element = findElementWithInfo(info);\r\n      if (element) {\r\n        return { element, info };\r\n      }\r\n    }\r\n    // \uC544\uC9C1 \uBABB \uCC3E\uC558\uB2E4\uBA74 \uC7A0\uAE50 \uB300\uAE30 \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574 DOM \uBCC0\uD654\uB97C \uAE30\uB2E4\uB9B0\uB2E4.\r\n    await new Promise((resolve) => setTimeout(resolve, retryInterval));\r\n  }\r\n  for (const info of infos) {\r\n    // \uC81C\uD55C \uC2DC\uAC04\uC744 \uB118\uACBC\uB2E4\uBA74 \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uD55C \uBC88 \uB354 \uC21C\uD68C\uD574\uBCF4\uB418 \uBC14\uB85C \uBC18\uD658\uD55C\uB2E4.\r\n    const element = findElementWithInfo(info);\r\n    if (element) {\r\n      return { element, info };\r\n    }\r\n  }\r\n  return { element: null, info: null };\r\n}\r\n\r\nexport function getSelectorCore(selector) {\r\n  if (!selector) return '';\r\n  if (selector.startsWith('css=')) return selector.slice(4);\r\n  if (selector.startsWith('xpath=')) return selector.slice(6);\r\n  if (selector.startsWith('text=')) return selector.slice(5);\r\n  return selector;\r\n}\r\n\r\n", "/**\r\n * DevTools \uD328\uB110\uC5D0\uC11C \uC694\uCCAD\uD55C \uB9AC\uD50C\uB808\uC774/\uC120\uD0DD \uB3D9\uC791\uC744 \uC2E4\uC81C DOM\uC5D0 \uC801\uC6A9\uD55C\uB2E4.\r\n * - \uB179\uD654\uB41C \uC774\uBCA4\uD2B8 \uC7AC\uC0DD\r\n * - \uC120\uD0DD \uC6CC\uD06C\uD50C\uB85C\uC6B0 \uB0B4 \uC989\uC2DC \uC2E4\uD589 \uC561\uC158\r\n */\r\nimport { findElementByPath, getSelectorCore, locateElementForEvent } from '../dom/locator.js';\r\n\r\n/**\r\n * \uB179\uD654\uB41C \uB2E8\uC77C \uC774\uBCA4\uD2B8\uB97C \uC2E4\uC81C DOM\uC5D0 \uC7AC\uC801\uC6A9\uD558\uACE0 \uACB0\uACFC\uB97C DevTools\uB85C \uD1B5\uC9C0\uD55C\uB2E4.\r\n */\r\nexport async function executeReplayStep({ event, index = 0, total = 0, timeoutMs = 6000 }) {\r\n  const { element, info } = await locateElementForEvent(event, timeoutMs);\r\n  if (!element) {\r\n    // \uC694\uC18C\uB97C \uCC3E\uC9C0 \uBABB\uD588\uC73C\uBA74 \uC989\uC2DC \uC2E4\uD328 \uBA54\uC2DC\uC9C0\uB97C \uBCF4\uB0B8\uB2E4.\r\n    const payload = {\r\n      type: 'REPLAY_STEP_RESULT',\r\n      ok: false,\r\n      reason: 'not_found',\r\n      stepIndex: index,\r\n      total,\r\n      selector: info && info.selector ? info.selector : (event && event.primarySelector) || null,\r\n      ev: event\r\n    };\r\n    chrome.runtime.sendMessage(payload);\r\n    return { ok: false, reason: 'not_found' };\r\n  }\r\n\r\n  let navigationTriggered = false;\r\n  const beforeUnloadHandler = () => {\r\n    // \uB9AC\uD50C\uB808\uC774 \uC911 \uB124\uBE44\uAC8C\uC774\uC158\uC774 \uBC1C\uC0DD\uD588\uB294\uC9C0\uB97C \uAE30\uB85D\uD574 \uC804\uB2EC\uD55C\uB2E4.\r\n    navigationTriggered = true;\r\n  };\r\n  window.addEventListener('beforeunload', beforeUnloadHandler);\r\n\r\n  const originalOutline = element.style.outline;\r\n  const originalOutlineOffset = element.style.outlineOffset;\r\n  let success = false;\r\n  let failureReason = '';\r\n  let extractedValue;\r\n  let manualActionType = event && event.manualActionType ? event.manualActionType : null;\r\n  let manualAttributeName = event && event.manualAttribute ? event.manualAttribute : null;\r\n\r\n  try {\r\n    element.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n    await new Promise((resolve) => setTimeout(resolve, 200));\r\n    try {\r\n      element.focus({ preventScroll: true });\r\n    } catch (focusErr) {\r\n      try {\r\n        element.focus();\r\n      } catch (focusErr2) {\r\n        // ignore\r\n      }\r\n    }\r\n    // \uD604\uC7AC \uC2E4\uD589 \uC911\uC778 \uC774\uBCA4\uD2B8\uC784\uC744 \uB208\uC5D0 \uB744\uAC8C \uD45C\uC2DC\uD55C\uB2E4.\r\n    element.style.outline = '3px solid rgba(0,150,136,0.6)';\r\n    element.style.outlineOffset = '2px';\r\n\r\n    if (event.action === 'click') {\r\n      const style = window.getComputedStyle(element);\r\n      if (style.display === 'none' || style.visibility === 'hidden' || style.opacity === '0') {\r\n        throw new Error('element not visible');\r\n      }\r\n      if (element.disabled) {\r\n        throw new Error('element disabled');\r\n      }\r\n      element.dispatchEvent(new MouseEvent('mouseover', { bubbles: true }));\r\n      element.dispatchEvent(new MouseEvent('mousedown', { bubbles: true }));\r\n      element.dispatchEvent(new MouseEvent('mouseup', { bubbles: true }));\r\n      element.dispatchEvent(new MouseEvent('click', { bubbles: true }));\r\n    } else if (event.action === 'input') {\r\n      const valueToSet = event.value || '';\r\n      if ('value' in element) {\r\n        element.value = valueToSet;\r\n      } else if (element.isContentEditable) {\r\n        element.textContent = valueToSet;\r\n      }\r\n      element.dispatchEvent(new Event('input', { bubbles: true }));\r\n      element.dispatchEvent(new Event('change', { bubbles: true }));\r\n    } else if (event.action === 'manual_extract_text') {\r\n      extractedValue = element.innerText || element.textContent || '';\r\n      manualActionType = 'extract_text';\r\n    } else if (event.action === 'manual_get_attribute') {\r\n      const attrName = manualAttributeName || event.manualAttribute || event.attributeName || '';\r\n      manualAttributeName = attrName;\r\n      extractedValue = attrName ? element.getAttribute(attrName) : null;\r\n      manualActionType = 'get_attribute';\r\n    } else {\r\n      throw new Error('unsupported action');\r\n    }\r\n\r\n    success = true;\r\n  } catch (err) {\r\n    failureReason = err && err.message ? err.message : 'unknown error';\r\n  } finally {\r\n    window.removeEventListener('beforeunload', beforeUnloadHandler);\r\n    try {\r\n      element.style.outline = originalOutline;\r\n      element.style.outlineOffset = originalOutlineOffset;\r\n    } catch (cleanupErr) {\r\n      // ignore style cleanup errors\r\n    }\r\n  }\r\n\r\n  const usedSelector = info && info.selector ? info.selector : (event && event.primarySelector) || (event && event.tag ? event.tag.toLowerCase() : null);\r\n  const payload = {\r\n    type: 'REPLAY_STEP_RESULT',\r\n    ok: success,\r\n    reason: success ? undefined : failureReason,\r\n    used: element && element.tagName,\r\n    selector: usedSelector,\r\n    stepIndex: index,\r\n    total,\r\n    navigation: navigationTriggered,\r\n    ev: event,\r\n    manualActionType: manualActionType || undefined,\r\n    manualActionId: event && event.manualActionId ? event.manualActionId : undefined,\r\n    value: extractedValue,\r\n    attributeName: manualAttributeName || undefined,\r\n    resultName: event && event.manualResultName ? event.manualResultName : undefined\r\n  };\r\n  chrome.runtime.sendMessage(payload);\r\n\r\n  if (success) {\r\n    return { ok: true, navigation: navigationTriggered, value: extractedValue };\r\n  }\r\n  return { ok: false, reason: failureReason };\r\n}\r\n\r\nexport function executeSelectionAction(action, path) {\r\n  const target = findElementByPath(path);\r\n  if (!target) {\r\n    return { ok: false, reason: 'not_found' };\r\n  }\r\n  if (action === 'click') {\r\n    try {\r\n      target.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n      // highlight \uC644\uB8CC \uD6C4 \uC7A0\uC2DC \uB300\uAE30\uD55C \uB4A4 \uC2E4\uC81C \uD074\uB9AD \uC774\uBCA4\uD2B8\uB97C \uC1A1\uCD9C\uD55C\uB2E4.\r\n      setTimeout(() => {\r\n        try {\r\n          target.focus({ preventScroll: true });\r\n        } catch (focusErr) {\r\n          try {\r\n            target.focus();\r\n          } catch (focusErr2) {\r\n            // ignore\r\n          }\r\n        }\r\n        const style = window.getComputedStyle(target);\r\n        if (style.display === 'none' || style.visibility === 'hidden' || style.opacity === '0') {\r\n          return;\r\n        }\r\n        if (target.disabled) {\r\n          return;\r\n        }\r\n        target.dispatchEvent(new MouseEvent('mouseover', { bubbles: true }));\r\n        target.dispatchEvent(new MouseEvent('mousedown', { bubbles: true }));\r\n        target.dispatchEvent(new MouseEvent('mouseup', { bubbles: true }));\r\n        target.dispatchEvent(new MouseEvent('click', { bubbles: true }));\r\n      }, 120);\r\n      return { ok: true };\r\n    } catch (err) {\r\n      return { ok: false, reason: err.message || 'click_failed' };\r\n    }\r\n  }\r\n  return { ok: false, reason: 'unsupported_action' };\r\n}\r\n\r\nexport { getSelectorCore };\r\n\r\n", "/**\r\n * \uCF58\uD150\uCE20 \uC2A4\uD06C\uB9BD\uD2B8 \uC804\uC5ED \uC0C1\uD0DC\uB97C \uBAA8\uC544\uB450\uB294 \uB2E8\uC21C \uC2A4\uD1A0\uB9AC\uC9C0.\r\n * \uB2E4\uB978 \uBAA8\uB4C8\uC5D0\uC11C \uC9C1\uC811 import\uD558\uC5EC \uCC38\uC870\uD55C\uB2E4.\r\n */\r\nexport const recorderState = {\r\n  isRecording: false,\r\n  currentHighlightedElement: null,\r\n  overlayElement: null,\r\n  hoverTimeout: null,\r\n  mouseoutTimeout: null,\r\n  scrollTimeout: null\r\n};\r\n\r\nexport const elementSelectionState = {\r\n  active: false,\r\n  mode: null,\r\n  currentElement: null,\r\n  parentElement: null,\r\n  highlightInfo: null,\r\n  childFlashTimeout: null,\r\n  stack: []\r\n};\r\n\r\nexport const overlayControlsState = {\r\n  container: null,\r\n  handle: null,\r\n  buttons: {},\r\n  status: null,\r\n  closeButton: null,\r\n  visible: false,\r\n  dragging: false,\r\n  dragOffsetX: 0,\r\n  dragOffsetY: 0\r\n};\r\n\r\nexport const inputTimers = new WeakMap();\r\n\r\n", "/**\r\n * \uD398\uC774\uC9C0 \uC0C1\uB2E8\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC624\uBC84\uB808\uC774 \uBC0F \uD558\uC774\uB77C\uC774\uD2B8 UI\uB97C \uAD00\uB9AC\uD55C\uB2E4.\r\n * - \uB179\uD654 \uC81C\uC5B4 \uBC84\uD2BC\r\n * - \uC694\uC18C \uD558\uC774\uB77C\uC774\uD2B8 \uBC0F \uC140\uB809\uD130 \uD31D\uC624\uBC84\r\n * - \uC704\uCE58/\uC0C1\uD0DC \uBCF5\uC6D0 \uBC0F Chrome \uBA54\uC2DC\uC9C0 \uC5F0\uB3D9\r\n */\r\nimport { getSelectorCandidates, getIframeContext } from '../selectors/index.js';\r\nimport { elementSelectionState, overlayControlsState, recorderState } from '../state.js';\r\nimport { buildDomContextSnapshot } from '../utils/dom.js';\r\n\r\n/**\r\n * \uD604\uC7AC \uC624\uBC84\uB808\uC774 \uC704\uCE58\uB97C \uC800\uC7A5\uD574 \uC0C8\uB85C\uACE0\uCE68 \uD6C4\uC5D0\uB3C4 \uB3D9\uC77C \uC704\uCE58\uB97C \uC720\uC9C0\uD55C\uB2E4.\r\n */\r\nfunction saveOverlayPosition(left, top) {\r\n  chrome.storage.local.set({ overlayPosition: { left, top } });\r\n}\r\n\r\n/**\r\n * \uC624\uBC84\uB808\uC774 \uC0C1\uD0DC \uD14D\uC2A4\uD2B8\uB97C \uAC31\uC2E0\uD558\uACE0 \uD1A4(\uC0C9\uC0C1)\uC744 \uC801\uC6A9\uD55C\uB2E4.\r\n */\r\nexport function setOverlayStatus(message, tone = 'info') {\r\n  if (!overlayControlsState.status) return;\r\n  overlayControlsState.status.textContent = message || '';\r\n  overlayControlsState.status.setAttribute('data-tone', tone || 'info');\r\n  overlayControlsState.status.style.display = message ? 'block' : 'none';\r\n}\r\n\r\n/**\r\n * \uB179\uD654 \uBC84\uD2BC \uD65C\uC131\uD654 \uC0C1\uD0DC \uBC0F \uC120\uD0DD \uD50C\uB798\uADF8\uB97C UI\uC5D0 \uBC18\uC601\uD55C\uB2E4.\r\n */\r\nexport function updateOverlayControlsState() {\r\n  if (!overlayControlsState.buttons.start || !overlayControlsState.container) return;\r\n  overlayControlsState.buttons.start.disabled = !!recorderState.isRecording;\r\n  overlayControlsState.buttons.stop.disabled = !recorderState.isRecording;\r\n  overlayControlsState.container.toggleAttribute('data-selecting', !!elementSelectionState.mode);\r\n}\r\n\r\n/**\r\n * \uB4DC\uB798\uADF8 \uC911 \uB9C8\uC6B0\uC2A4 \uC774\uB3D9 \uC774\uBCA4\uD2B8\uB85C \uCEE8\uD2B8\uB864 \uD328\uB110 \uC704\uCE58\uB97C \uC5C5\uB370\uC774\uD2B8\uD55C\uB2E4.\r\n */\r\nfunction onOverlayDragMove(event) {\r\n  if (!overlayControlsState.dragging || !overlayControlsState.container) return;\r\n  const container = overlayControlsState.container;\r\n  const width = container.offsetWidth;\r\n  const height = container.offsetHeight;\r\n  let newLeft = event.clientX - overlayControlsState.dragOffsetX;\r\n  let newTop = event.clientY - overlayControlsState.dragOffsetY;\r\n  const margin = 8;\r\n  newLeft = Math.max(margin, Math.min(newLeft, window.innerWidth - width - margin));\r\n  newTop = Math.max(margin, Math.min(newTop, window.innerHeight - height - margin));\r\n  container.style.left = `${newLeft}px`;\r\n  container.style.top = `${newTop}px`;\r\n  container.style.right = '';\r\n  container.style.bottom = '';\r\n}\r\n\r\n/**\r\n * \uB4DC\uB798\uADF8\uB97C \uC885\uB8CC\uD558\uACE0 \uC704\uCE58\uB97C \uC800\uC7A5\uD55C\uB2E4.\r\n */\r\nfunction stopOverlayDrag() {\r\n  if (!overlayControlsState.dragging || !overlayControlsState.container) return;\r\n  overlayControlsState.dragging = false;\r\n  document.removeEventListener('mousemove', onOverlayDragMove, true);\r\n  document.removeEventListener('mouseup', stopOverlayDrag, true);\r\n  const rect = overlayControlsState.container.getBoundingClientRect();\r\n  saveOverlayPosition(rect.left, rect.top);\r\n}\r\n\r\n/**\r\n * \uC0AC\uC6A9\uC790\uAC00 \uD5E4\uB354\uB97C \uB204\uB974\uBA74 \uB4DC\uB798\uADF8 \uC0C1\uD0DC\uB97C \uC2DC\uC791\uD55C\uB2E4.\r\n */\r\nfunction startOverlayDrag(event) {\r\n  if (!overlayControlsState.container) return;\r\n  const rect = overlayControlsState.container.getBoundingClientRect();\r\n  overlayControlsState.dragging = true;\r\n  overlayControlsState.dragOffsetX = event.clientX - rect.left;\r\n  overlayControlsState.dragOffsetY = event.clientY - rect.top;\r\n  overlayControlsState.container.style.left = `${rect.left}px`;\r\n  overlayControlsState.container.style.top = `${rect.top}px`;\r\n  overlayControlsState.container.style.right = '';\r\n  overlayControlsState.container.style.bottom = '';\r\n  document.addEventListener('mousemove', onOverlayDragMove, true);\r\n  document.addEventListener('mouseup', stopOverlayDrag, true);\r\n  event.preventDefault();\r\n}\r\n\r\n/**\r\n * \uC624\uBC84\uB808\uC774 \uBA85\uB839\uC5D0 \uB300\uD55C \uC751\uB2F5\uC744 UI \uBA54\uC2DC\uC9C0\uB85C \uBCC0\uD658\uD55C\uB2E4.\r\n */\r\nfunction handleOverlayCommandResponse(command, response) {\r\n  if (!response || response.ok) {\r\n    if (command === 'start_record') {\r\n      setOverlayStatus('\uB179\uD654\uB97C \uC2DC\uC791\uD588\uC2B5\uB2C8\uB2E4.', 'success');\r\n    } else if (command === 'stop_record') {\r\n      setOverlayStatus('\uB179\uD654\uB97C \uC911\uC9C0\uD588\uC2B5\uB2C8\uB2E4.', 'success');\r\n    } else if (command === 'element_select') {\r\n      setOverlayStatus('\uC694\uC18C \uC120\uD0DD \uBAA8\uB4DC\uB97C \uC2DC\uC791\uD569\uB2C8\uB2E4. \uD398\uC774\uC9C0\uC5D0\uC11C \uC694\uC18C\uB97C \uD074\uB9AD\uD558\uC138\uC694.', 'info');\r\n    }\r\n    return;\r\n  }\r\n  const reason = response.reason || 'unknown';\r\n  let message = '\uC694\uCCAD\uC744 \uCC98\uB9AC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.';\r\n  if (reason === 'already_recording') {\r\n    message = '\uC774\uBBF8 \uB179\uD654 \uC911\uC785\uB2C8\uB2E4.';\r\n  } else if (reason === 'no_active_tab') {\r\n    message = '\uD65C\uC131 \uD0ED\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.';\r\n  } else if (reason === 'not_recording') {\r\n    message = '\uD604\uC7AC \uB179\uD654 \uC911\uC774 \uC544\uB2D9\uB2C8\uB2E4.';\r\n  } else if (reason === 'selection_in_progress') {\r\n    message = '\uC774\uBBF8 \uC694\uC18C \uC120\uD0DD\uC774 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4.';\r\n  } else if (reason === 'parent_not_selected') {\r\n    message = '\uBA3C\uC800 \uBD80\uBAA8 \uC694\uC18C\uB97C \uC120\uD0DD\uD558\uC138\uC694.';\r\n  } else if (reason === 'unsupported_action') {\r\n    message = '\uC9C0\uC6D0\uD558\uC9C0 \uC54A\uB294 \uB3D9\uC791\uC785\uB2C8\uB2E4.';\r\n  }\r\n  setOverlayStatus(message, 'error');\r\n}\r\n\r\n/**\r\n * DevTools \uD328\uB110\uB85C \uBA85\uB839\uC744 \uC804\uC1A1\uD558\uACE0 \uC751\uB2F5 \uCC98\uB9AC.\r\n */\r\nexport function sendOverlayCommand(command, options = {}) {\r\n  chrome.runtime.sendMessage({ type: 'OVERLAY_COMMAND', command, options }, (response) => {\r\n    if (chrome.runtime.lastError) {\r\n      setOverlayStatus('DevTools \uD328\uB110\uACFC \uD1B5\uC2E0\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uD328\uB110\uC774 \uC5F4\uB824 \uC788\uB294\uC9C0 \uD655\uC778\uD558\uC138\uC694.', 'error');\r\n      return;\r\n    }\r\n    handleOverlayCommandResponse(command, response);\r\n  });\r\n}\r\n\r\n/**\r\n * \uC800\uC7A5\uB41C \uC704\uCE58\uAC00 \uC788\uB2E4\uBA74 \uC624\uBC84\uB808\uC774\uB97C \uADF8 \uC88C\uD45C\uB85C \uC774\uB3D9\uC2DC\uD0A8\uB2E4.\r\n */\r\nfunction restoreOverlayPosition(container) {\r\n  chrome.storage.local.get({ overlayPosition: null }, (data) => {\r\n    const pos = data.overlayPosition;\r\n    if (pos && typeof pos.left === 'number' && typeof pos.top === 'number') {\r\n      container.style.left = `${pos.left}px`;\r\n      container.style.top = `${pos.top}px`;\r\n      container.style.right = '';\r\n      container.style.bottom = '';\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * DevTools \uD328\uB110\uACFC \uB3D9\uC77C\uD55C UI \uCEE8\uD2B8\uB864\uC744 \uD398\uC774\uC9C0\uC5D0 \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nexport function createOverlayControls() {\r\n  if (overlayControlsState.container) return;\r\n  if (window !== window.top) return;\r\n\r\n  const container = document.createElement('div');\r\n  container.id = '__ai_test_overlay__';\r\n  container.style.position = 'fixed';\r\n  container.style.right = '24px';\r\n  container.style.bottom = '24px';\r\n  container.style.background = 'rgba(15, 23, 42, 0.65)';\r\n  container.style.backdropFilter = 'blur(12px)';\r\n  container.style.border = '1px solid rgba(255,255,255,0.18)';\r\n  container.style.borderRadius = '12px';\r\n  container.style.padding = '12px';\r\n  container.style.color = '#fff';\r\n  container.style.fontFamily = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, sans-serif';\r\n  container.style.fontSize = '12px';\r\n  container.style.boxShadow = '0 12px 24px rgba(11, 15, 25, 0.35)';\r\n  container.style.zIndex = '2147483646';\r\n  container.style.minWidth = '200px';\r\n  container.style.userSelect = 'none';\r\n\r\n  const handle = document.createElement('div');\r\n  handle.style.display = 'flex';\r\n  handle.style.alignItems = 'center';\r\n  handle.style.justifyContent = 'space-between';\r\n  handle.style.fontWeight = '600';\r\n  handle.style.fontSize = '11px';\r\n  handle.style.textTransform = 'uppercase';\r\n  handle.style.letterSpacing = '0.08em';\r\n  handle.style.marginBottom = '10px';\r\n  handle.style.cursor = 'move';\r\n\r\n  const handleTitle = document.createElement('span');\r\n  handleTitle.textContent = 'Recorder Controls';\r\n  handleTitle.style.flex = '1 1 auto';\r\n\r\n  const closeBtn = document.createElement('button');\r\n  closeBtn.type = 'button';\r\n  closeBtn.textContent = 'x';\r\n  closeBtn.setAttribute('aria-label', '\uC624\uBC84\uB808\uC774 \uB2EB\uAE30');\r\n  closeBtn.style.cssText = 'margin-left:8px;flex:0 0 auto;width:20px;height:20px;border:none;border-radius:4px;background:transparent;color:rgba(255,255,255,0.7);font-size:12px;line-height:1;cursor:pointer;padding:0;';\r\n  closeBtn.addEventListener('click', (event) => {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    setOverlayVisibility(false);\r\n  });\r\n  closeBtn.addEventListener('mousedown', (event) => {\r\n    event.stopPropagation();\r\n  });\r\n  closeBtn.addEventListener('mouseenter', () => {\r\n    closeBtn.style.background = 'rgba(255,255,255,0.15)';\r\n  });\r\n  closeBtn.addEventListener('mouseleave', () => {\r\n    closeBtn.style.background = 'transparent';\r\n  });\r\n\r\n  handle.appendChild(handleTitle);\r\n  handle.appendChild(closeBtn);\r\n\r\n  const buttonsRow = document.createElement('div');\r\n  buttonsRow.style.display = 'flex';\r\n  buttonsRow.style.gap = '8px';\r\n  buttonsRow.style.flexWrap = 'nowrap';\r\n\r\n  const buttonStyle = 'flex:1 1 auto;padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.18);background:rgba(255,255,255,0.14);color:#fff;font-size:12px;font-weight:600;cursor:pointer;transition:all 0.2s ease;text-align:center;';\r\n\r\n  const startBtn = document.createElement('button');\r\n  startBtn.textContent = 'Start';\r\n  startBtn.style.cssText = buttonStyle;\r\n  startBtn.addEventListener('click', () => {\r\n    setOverlayStatus('\uB179\uD654\uB97C \uC2DC\uC791\uD558\uB294 \uC911...', 'info');\r\n    sendOverlayCommand('start_record');\r\n  });\r\n\r\n  const stopBtn = document.createElement('button');\r\n  stopBtn.textContent = 'Stop';\r\n  stopBtn.style.cssText = buttonStyle;\r\n  stopBtn.addEventListener('click', () => {\r\n    setOverlayStatus('\uB179\uD654\uB97C \uC911\uC9C0\uD558\uB294 \uC911...', 'info');\r\n    sendOverlayCommand('stop_record');\r\n  });\r\n\r\n  const selectBtn = document.createElement('button');\r\n  selectBtn.textContent = 'Select';\r\n  selectBtn.style.cssText = buttonStyle;\r\n  selectBtn.addEventListener('click', () => {\r\n    setOverlayStatus('\uC694\uC18C \uC120\uD0DD \uBAA8\uB4DC\uB97C \uC900\uBE44\uD558\uB294 \uC911...', 'info');\r\n    sendOverlayCommand('element_select');\r\n  });\r\n\r\n  buttonsRow.appendChild(startBtn);\r\n  buttonsRow.appendChild(stopBtn);\r\n  buttonsRow.appendChild(selectBtn);\r\n\r\n  const status = document.createElement('div');\r\n  status.style.marginTop = '10px';\r\n  status.style.fontSize = '11px';\r\n  status.style.padding = '6px 8px';\r\n  status.style.borderRadius = '8px';\r\n  status.style.background = 'rgba(255,255,255,0.12)';\r\n  status.style.display = 'none';\r\n\r\n  container.appendChild(handle);\r\n  container.appendChild(buttonsRow);\r\n  container.appendChild(status);\r\n\r\n  handle.addEventListener('mousedown', startOverlayDrag, true);\r\n\r\n  const observer = new MutationObserver(() => {\r\n    // button disable \uC0C1\uD0DC \uB4F1 \uC18D\uC131 \uBCC0\uACBD\uC2DC \uCD5C\uC2E0 \uC0C1\uD0DC\uB97C \uBC18\uC601.\r\n    updateOverlayControlsState();\r\n  });\r\n  observer.observe(container, { attributes: true });\r\n\r\n  overlayControlsState.container = container;\r\n  overlayControlsState.handle = handle;\r\n  overlayControlsState.buttons = { start: startBtn, stop: stopBtn, select: selectBtn };\r\n  overlayControlsState.status = status;\r\n  overlayControlsState.closeButton = closeBtn;\r\n  overlayControlsState.visible = false;\r\n\r\n  container.style.display = 'none';\r\n  document.body.appendChild(container);\r\n  restoreOverlayPosition(container);\r\n  updateOverlayControlsState();\r\n  setOverlayStatus('', 'info');\r\n}\r\n\r\nexport function isOverlayVisible() {\r\n  return !!overlayControlsState.visible;\r\n}\r\n\r\n/**\r\n * \uC624\uBC84\uB808\uC774 \uD45C\uC2DC \uC5EC\uBD80\uB97C \uD1A0\uAE00\uD558\uACE0 \uD544\uC694 \uC2DC \uC0C1\uD0DC\uB97C \uC800\uC7A5/\uD1B5\uC9C0\uD55C\uB2E4.\r\n */\r\nexport function setOverlayVisibility(visible, options = {}) {\r\n  if (window !== window.top) return false;\r\n  if (!overlayControlsState.container) {\r\n    createOverlayControls();\r\n  }\r\n  const container = overlayControlsState.container;\r\n  if (!container) return false;\r\n\r\n  const target = !!visible;\r\n  const changed = overlayControlsState.visible !== target;\r\n  overlayControlsState.visible = target;\r\n\r\n  if (target) {\r\n    container.style.display = 'block';\r\n    updateOverlayControlsState();\r\n  } else {\r\n    stopOverlayDrag();\r\n    container.style.display = 'none';\r\n    setOverlayStatus('', 'info');\r\n  }\r\n\r\n  if (changed) {\r\n    chrome.storage.local.set({ overlayVisible: target });\r\n  }\r\n\r\n  if (changed && options.notify !== false) {\r\n    // DevTools \uD328\uB110\uACFC \uB3D9\uAE30\uD654\uB97C \uC704\uD574 \uBCC0\uACBD \uC0AC\uC2E4\uC744 \uC54C\uB9B0\uB2E4.\r\n    chrome.runtime.sendMessage({ type: 'OVERLAY_VISIBILITY_CHANGED', visible: target });\r\n  }\r\n\r\n  return changed;\r\n}\r\n\r\n/**\r\n * \uD558\uC774\uB77C\uC774\uD2B8 \uD31D\uC624\uBC84\uC5D0 \uD45C\uC2DC\uD560 HTML \uBB38\uC790\uC5F4\uC744 \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nfunction buildOverlayHtml(topSelector, selectors) {\r\n  if (!topSelector) {\r\n    return '<div style=\"color: #ff9800;\">No selector found</div>';\r\n  }\r\n  // \uCCAB \uBC88\uC9F8 \uD6C4\uBCF4 \uC678\uC758 \uC140\uB809\uD130\uAC00 \uC788\uB2E4\uBA74 \uAC1C\uC218\uB97C \uC54C\uB824\uC900\uB2E4.\r\n  const more = selectors.length > 1 ? `<div style=\"font-size: 10px; color: #888; margin-top: 4px;\">+${selectors.length - 1} more</div>` : '';\r\n  return `\r\n    <div style=\"font-weight: bold; margin-bottom: 4px; color: #4CAF50;\">${topSelector.selector}</div>\r\n    <div style=\"font-size: 10px; color: #aaa;\">Score: ${topSelector.score}% \u2022 ${topSelector.reason}</div>\r\n    ${more}\r\n  `;\r\n}\r\n\r\nfunction updateOverlayPosition(rect) {\r\n  const { overlayElement } = recorderState;\r\n  if (!overlayElement) return;\r\n  const overlayHeight = overlayElement.offsetHeight;\r\n  const overlayWidth = overlayElement.offsetWidth;\r\n  const overlayTop = rect.top - overlayHeight - 10;\r\n  const overlayBottom = rect.bottom + 10;\r\n\r\n  if (overlayTop >= 0) {\r\n    overlayElement.style.top = `${overlayTop}px`;\r\n    overlayElement.style.left = `${rect.left}px`;\r\n  } else {\r\n    overlayElement.style.top = `${overlayBottom}px`;\r\n    overlayElement.style.left = `${rect.left}px`;\r\n  }\r\n\r\n  const maxLeft = window.innerWidth - overlayWidth - 10;\r\n  const currentLeft = parseInt(overlayElement.style.left, 10) || 0;\r\n  if (currentLeft > maxLeft) {\r\n    overlayElement.style.left = `${Math.max(10, maxLeft)}px`;\r\n  }\r\n  if (currentLeft < 10) {\r\n    overlayElement.style.left = '10px';\r\n  }\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD\uB41C \uC694\uC18C\uC758 \uC704\uCE58 \uADFC\uCC98\uC5D0 \uC140\uB809\uD130 \uC815\uBCF4 \uD48D\uC120\uC744 \uC0DD\uC131\uD55C\uB2E4.\r\n */\r\nfunction createSelectorOverlay(rect, selectors) {\r\n  if (recorderState.overlayElement) {\r\n    recorderState.overlayElement.remove();\r\n    recorderState.overlayElement = null;\r\n  }\r\n\r\n  // \uC0C8 \uD31D\uC624\uBC84\uB97C \uC0DD\uC131\uD574 \uC120\uD0DD\uB41C \uC694\uC18C\uC758 \uC140\uB809\uD130 \uC815\uBCF4\uB97C \uD45C\uC2DC\uD55C\uB2E4.\r\n  const overlay = document.createElement('div');\r\n  overlay.id = '__ai_test_recorder_overlay__';\r\n  overlay.style.cssText = `\r\n    position: fixed;\r\n    z-index: 999999;\r\n    background: rgba(0, 0, 0, 0.85);\r\n    color: white;\r\n    padding: 8px 12px;\r\n    border-radius: 6px;\r\n    font-family: 'Courier New', monospace;\r\n    font-size: 12px;\r\n    pointer-events: none;\r\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n    max-width: 300px;\r\n    word-break: break-all;\r\n    line-height: 1.4;\r\n  `;\r\n\r\n  overlay.innerHTML = buildOverlayHtml(selectors[0], selectors);\r\n  document.body.appendChild(overlay);\r\n  recorderState.overlayElement = overlay;\r\n  updateOverlayPosition(rect);\r\n}\r\n\r\n/**\r\n * \uD604\uC7AC \uD558\uC774\uB77C\uC774\uD2B8\uC640 \uD31D\uC624\uBC84\uB97C \uBAA8\uB450 \uC81C\uAC70\uD55C\uB2E4.\r\n */\r\nexport function removeHighlight() {\r\n  if (recorderState.currentHighlightedElement) {\r\n    recorderState.currentHighlightedElement.style.outline = '';\r\n    recorderState.currentHighlightedElement.style.outlineOffset = '';\r\n    recorderState.currentHighlightedElement = null;\r\n  }\r\n  if (recorderState.overlayElement) {\r\n    recorderState.overlayElement.remove();\r\n    recorderState.overlayElement = null;\r\n  }\r\n}\r\n\r\n/**\r\n * \uBD80\uBAA8 \uC694\uC18C \uAC15\uC870(\uC810\uC120)\uB97C \uC801\uC6A9\uD574 \uD604\uC7AC \uC120\uD0DD \uCEE8\uD14D\uC2A4\uD2B8\uB97C \uBCF4\uC5EC\uC900\uB2E4.\r\n */\r\nexport function applySelectionParentHighlight(element) {\r\n  if (!element || element.nodeType !== 1) return;\r\n  if (elementSelectionState.highlightInfo && elementSelectionState.highlightInfo.element !== element) {\r\n    clearSelectionParentHighlight();\r\n  }\r\n  if (!elementSelectionState.highlightInfo) {\r\n    elementSelectionState.highlightInfo = {\r\n      element,\r\n      outline: element.style.outline,\r\n      outlineOffset: element.style.outlineOffset\r\n    };\r\n    element.style.outline = '2px dashed rgba(255,152,0,0.95)';\r\n    element.style.outlineOffset = '2px';\r\n  }\r\n}\r\n\r\nexport function clearSelectionParentHighlight() {\r\n  if (elementSelectionState.highlightInfo && elementSelectionState.highlightInfo.element) {\r\n    const { element, outline, outlineOffset } = elementSelectionState.highlightInfo;\r\n    try {\r\n      element.style.outline = outline || '';\r\n      element.style.outlineOffset = outlineOffset || '';\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }\r\n  elementSelectionState.highlightInfo = null;\r\n}\r\n\r\nexport function flashSelectionElement(element, duration = 1500) {\r\n  if (!element || element.nodeType !== 1) return;\r\n  if (elementSelectionState.childFlashTimeout) {\r\n    clearTimeout(elementSelectionState.childFlashTimeout);\r\n    elementSelectionState.childFlashTimeout = null;\r\n  }\r\n  const prev = {\r\n    outline: element.style.outline,\r\n    outlineOffset: element.style.outlineOffset\r\n  };\r\n  element.style.outline = '2px solid rgba(33,150,243,0.9)';\r\n  element.style.outlineOffset = '2px';\r\n  elementSelectionState.childFlashTimeout = setTimeout(() => {\r\n    try {\r\n      element.style.outline = prev.outline || '';\r\n      element.style.outlineOffset = prev.outlineOffset || '';\r\n    } catch (e) {\r\n      // ignore cleanup errors\r\n    }\r\n    elementSelectionState.childFlashTimeout = null;\r\n  }, duration);\r\n}\r\n\r\n/**\r\n * \uC9C0\uC815\uD55C \uC694\uC18C\uB97C \uAD75\uC740 \uD14C\uB450\uB9AC\uC640 \uD31D\uC624\uBC84\uB85C \uAC15\uC870 \uD45C\uC2DC\uD55C\uB2E4.\r\n */\r\nexport function highlightElement(element) {\r\n  if (!element) return;\r\n  const isSameElement = element === recorderState.currentHighlightedElement;\r\n  if (recorderState.currentHighlightedElement && !isSameElement) {\r\n    recorderState.currentHighlightedElement.style.outline = '';\r\n    recorderState.currentHighlightedElement.style.outlineOffset = '';\r\n  }\r\n\r\n  recorderState.currentHighlightedElement = element;\r\n  element.style.outline = '3px solid #2196F3';\r\n  element.style.outlineOffset = '2px';\r\n  element.style.transition = 'outline 0.1s ease';\r\n\r\n  const selectors = getSelectorCandidates(element);\r\n  const rect = element.getBoundingClientRect();\r\n  createSelectorOverlay(rect, selectors);\r\n\r\n  if (!isSameElement) {\r\n    // DevTools \uD328\uB110\uC5D0 hover\uB41C \uC694\uC18C \uC815\uBCF4\uB97C \uC804\uC1A1\uD574 UI\uB97C \uB3D9\uAE30\uD654\uD55C\uB2E4.\r\n    chrome.runtime.sendMessage({\r\n      type: 'ELEMENT_HOVERED',\r\n      selectors,\r\n      element: {\r\n        tag: element.tagName,\r\n        id: element.id || null,\r\n        classes: Array.from(element.classList || []),\r\n        domContext: buildDomContextSnapshot(element)\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * \uB179\uD654 \uC911 \uB9C8\uC6B0\uC2A4\uAC00 \uC694\uC18C \uC704\uC5D0 \uC62C\uB77C\uAC00\uBA74 \uD574\uB2F9 \uC694\uC18C\uB97C \uD558\uC774\uB77C\uC774\uD2B8\uD55C\uB2E4.\r\n */\r\nfunction handleMouseOver(event) {\r\n  if (!recorderState.isRecording) return;\r\n  if (recorderState.mouseoutTimeout) {\r\n    clearTimeout(recorderState.mouseoutTimeout);\r\n    recorderState.mouseoutTimeout = null;\r\n  }\r\n  const target = event.target;\r\n  if (!target || target === document.body || target === document.documentElement) {\r\n    removeHighlight();\r\n    return;\r\n  }\r\n  if (target.id === '__ai_test_recorder_overlay__' || target.closest('#__ai_test_recorder_overlay__')) {\r\n    return;\r\n  }\r\n  if (target !== recorderState.currentHighlightedElement) {\r\n    if (recorderState.hoverTimeout) {\r\n      clearTimeout(recorderState.hoverTimeout);\r\n    }\r\n    recorderState.hoverTimeout = setTimeout(() => highlightElement(target), 30);\r\n  } else if (recorderState.overlayElement) {\r\n    updateOverlayPosition(target.getBoundingClientRect());\r\n  }\r\n}\r\n\r\n/**\r\n * \uB179\uD654 \uC911 \uB9C8\uC6B0\uC2A4\uAC00 \uC694\uC18C \uBC16\uC73C\uB85C \uB098\uAC14\uC744 \uB54C \uD558\uC774\uB77C\uC774\uD2B8\uB97C \uC81C\uAC70\uD55C\uB2E4.\r\n */\r\nfunction handleMouseOut(event) {\r\n  if (!recorderState.isRecording) return;\r\n  const relatedTarget = event.relatedTarget;\r\n  if (relatedTarget && (relatedTarget.id === '__ai_test_recorder_overlay__' || relatedTarget.closest('#__ai_test_recorder_overlay__'))) {\r\n    return;\r\n  }\r\n  if (recorderState.hoverTimeout) {\r\n    clearTimeout(recorderState.hoverTimeout);\r\n    recorderState.hoverTimeout = null;\r\n  }\r\n  if (recorderState.mouseoutTimeout) {\r\n    clearTimeout(recorderState.mouseoutTimeout);\r\n  }\r\n  recorderState.mouseoutTimeout = setTimeout(() => {\r\n    const activeElement = document.elementFromPoint(event.clientX, event.clientY);\r\n    if (!activeElement || activeElement === document.body || activeElement === document.documentElement || (activeElement.id !== '__ai_test_recorder_overlay__' && !activeElement.closest('#__ai_test_recorder_overlay__'))) {\r\n      // \uB9C8\uC6B0\uC2A4\uAC00 \uC644\uC804\uD788 \uBC97\uC5B4\uB09C \uACBD\uC6B0\uC5D0\uB9CC \uD558\uC774\uB77C\uC774\uD2B8 \uC81C\uAC70.\r\n      if (activeElement !== recorderState.currentHighlightedElement && activeElement !== document.body && activeElement !== document.documentElement) {\r\n        removeHighlight();\r\n      }\r\n    }\r\n    recorderState.mouseoutTimeout = null;\r\n  }, 200);\r\n}\r\n\r\n/**\r\n * \uC2A4\uD06C\uB864 \uC2DC \uD558\uC774\uB77C\uC774\uD2B8 \uD31D\uC624\uBC84 \uC704\uCE58\uB97C \uC77C\uC815 \uAC04\uACA9\uC73C\uB85C \uAC31\uC2E0\uD55C\uB2E4.\r\n */\r\nfunction handleScroll() {\r\n  if (!recorderState.isRecording || !recorderState.currentHighlightedElement || !recorderState.overlayElement) return;\r\n  if (recorderState.scrollTimeout) {\r\n    clearTimeout(recorderState.scrollTimeout);\r\n  }\r\n  recorderState.scrollTimeout = setTimeout(() => {\r\n    const rect = recorderState.currentHighlightedElement.getBoundingClientRect();\r\n    updateOverlayPosition(rect);\r\n  }, 50);\r\n}\r\n\r\nexport function initOverlaySystem() {\r\n  createOverlayControls();\r\n  chrome.storage.local.get({ overlayVisible: false }, (data) => {\r\n    const storedVisible = !!data.overlayVisible;\r\n    setOverlayVisibility(storedVisible, { notify: false });\r\n  });\r\n  document.addEventListener('mouseover', handleMouseOver, true);\r\n  document.addEventListener('mouseout', handleMouseOut, true);\r\n  window.addEventListener('scroll', handleScroll, true);\r\n}\r\n\r\nexport function ensureRecordingState(isRecording) {\r\n  recorderState.isRecording = isRecording;\r\n  updateOverlayControlsState();\r\n}\r\n\r\n/**\r\n * \uB514\uBC84\uAE45/\uD14C\uC2A4\uD2B8 \uC6A9\uB3C4\uB85C \uD604\uC7AC \uC624\uBC84\uB808\uC774 \uC0C1\uD0DC\uB97C \uC870\uD68C\uD55C\uB2E4.\r\n */\r\nexport function getCurrentOverlayState() {\r\n  return {\r\n    overlayElement: recorderState.overlayElement,\r\n    currentHighlightedElement: recorderState.currentHighlightedElement,\r\n    visible: overlayControlsState.visible\r\n  };\r\n}\r\n\r\n", "/**\r\n * DevTools\uC5D0\uC11C \uC694\uCCAD\uD558\uB294 \uC694\uC18C \uC120\uD0DD \uC6CC\uD06C\uD50C\uB85C\uC6B0\uB97C \uCC98\uB9AC\uD55C\uB2E4.\r\n * \uB8E8\uD2B8/\uC790\uC2DD/\uBD80\uBAA8 \uC120\uD0DD \uD750\uB984\uACFC \uD558\uC774\uB77C\uC774\uD2B8 \uC0C1\uD0DC\uB97C \uC81C\uC5B4\uD55C\uB2E4.\r\n */\r\nimport { getChildSelectorCandidates, getIframeContext, getSelectorCandidates, getParentSelectorCandidates } from '../selectors/index.js';\r\nimport { elementSelectionState } from '../state.js';\r\nimport {\r\n  applySelectionParentHighlight,\r\n  clearSelectionParentHighlight,\r\n  flashSelectionElement,\r\n  highlightElement,\r\n  removeHighlight,\r\n  setOverlayStatus,\r\n  updateOverlayControlsState\r\n} from '../overlay/index.js';\r\nimport { buildDomContextSnapshot } from '../utils/dom.js';\r\n\r\n/**\r\n * \uBD80\uBAA8 \uD558\uC774\uB77C\uC774\uD2B8 \uBC0F \uC790\uC2DD \uD50C\uB798\uC2DC \uC0C1\uD0DC\uB97C \uCD08\uAE30\uD654\uD55C\uB2E4.\r\n */\r\nfunction resetSelectionHighlight() {\r\n  clearSelectionParentHighlight();\r\n  if (elementSelectionState.childFlashTimeout) {\r\n    clearTimeout(elementSelectionState.childFlashTimeout);\r\n    elementSelectionState.childFlashTimeout = null;\r\n  }\r\n}\r\n\r\n/**\r\n * \uB8E8\uD2B8 \uC694\uC18C \uC120\uD0DD\uC744 \uC2DC\uC791\uD558\uACE0 \uB0B4\uBD80 \uC0C1\uD0DC\uB97C \uCD08\uAE30\uD654\uD55C\uB2E4.\r\n */\r\nexport function beginRootSelection() {\r\n  elementSelectionState.active = true;\r\n  elementSelectionState.mode = 'root';\r\n  elementSelectionState.parentElement = null;\r\n  elementSelectionState.currentElement = null;\r\n  elementSelectionState.stack = [];\r\n  resetSelectionHighlight();\r\n  updateOverlayControlsState();\r\n}\r\n\r\n/**\r\n * \uD604\uC7AC \uC120\uD0DD\uB41C \uC694\uC18C\uB97C \uBD80\uBAA8\uB85C \uC0BC\uC544 \uC790\uC2DD \uC120\uD0DD \uB2E8\uACC4\uB85C \uC804\uD658\uD55C\uB2E4.\r\n */\r\nexport function beginChildSelection() {\r\n  if (!elementSelectionState.active || !elementSelectionState.currentElement) {\r\n    // \uBD80\uBAA8\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC740 \uC0C1\uD0DC\uC5D0\uC11C \uC790\uC2DD \uC694\uCCAD\uC774 \uC624\uBA74 \uC624\uB958.\r\n    return { ok: false, reason: 'parent_not_selected' };\r\n  }\r\n  elementSelectionState.mode = 'child';\r\n  elementSelectionState.parentElement = elementSelectionState.currentElement;\r\n  applySelectionParentHighlight(elementSelectionState.parentElement);\r\n  updateOverlayControlsState();\r\n  return { ok: true };\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD \uC6CC\uD06C\uD50C\uB85C\uC6B0\uB97C \uC644\uC804\uD788 \uC885\uB8CC\uD558\uACE0 UI \uC0C1\uD0DC\uB97C \uCD08\uAE30\uD654\uD55C\uB2E4.\r\n */\r\nexport function cancelSelection() {\r\n  elementSelectionState.mode = null;\r\n  elementSelectionState.active = false;\r\n  elementSelectionState.parentElement = null;\r\n  elementSelectionState.currentElement = null;\r\n  elementSelectionState.stack = [];\r\n  resetSelectionHighlight();\r\n  updateOverlayControlsState();\r\n}\r\n\r\n/**\r\n * DevTools \uD328\uB110\uB85C \uBCF4\uB0BC \uC694\uC18C \uC694\uC57D \uC815\uBCF4\uB97C \uB9CC\uB4E0\uB2E4.\r\n */\r\nfunction buildElementPayload(element) {\r\n  return {\r\n    tag: element.tagName,\r\n    text: (element.innerText || element.textContent || '').trim().slice(0, 80),\r\n    id: element.id || null,\r\n    classList: Array.from(element.classList || []),\r\n    iframeContext: getIframeContext(element),\r\n    domContext: buildDomContextSnapshot(element)\r\n  };\r\n}\r\n\r\n/**\r\n * \uB8E8\uD2B8 \uB2E8\uACC4\uC5D0\uC11C \uC0AC\uC6A9\uC790\uAC00 \uD074\uB9AD\uD55C \uC694\uC18C\uB97C \uC120\uD0DD \uCC98\uB9AC\uD55C\uB2E4.\r\n */\r\nfunction handleRootSelection(target) {\r\n  elementSelectionState.active = true;\r\n  elementSelectionState.currentElement = target;\r\n  elementSelectionState.parentElement = target;\r\n  elementSelectionState.mode = null;\r\n  elementSelectionState.stack = [{ element: target }];\r\n  applySelectionParentHighlight(target);\r\n  highlightElement(target);\r\n  const selectors = (getSelectorCandidates(target) || []).map((candidate) => ({\r\n    ...candidate,\r\n    relation: candidate.relation || 'global'\r\n  }));\r\n  chrome.runtime.sendMessage({\r\n    type: 'ELEMENT_SELECTION_PICKED',\r\n    stage: 'root',\r\n    selectors,\r\n    element: buildElementPayload(target)\r\n  });\r\n  updateOverlayControlsState();\r\n}\r\n\r\n/**\r\n * \uC790\uC2DD \uC120\uD0DD \uB2E8\uACC4\uC5D0\uC11C \uD074\uB9AD\uD55C \uC694\uC18C\uB97C \uD604\uC7AC \uACBD\uB85C\uC5D0 \uCD94\uAC00\uD55C\uB2E4.\r\n */\r\nfunction handleChildSelection(target) {\r\n  if (!elementSelectionState.parentElement || !elementSelectionState.parentElement.contains(target) || target === elementSelectionState.parentElement) {\r\n    chrome.runtime.sendMessage({\r\n      type: 'ELEMENT_SELECTION_ERROR',\r\n      stage: 'child',\r\n      reason: '\uC120\uD0DD\uD55C \uC694\uC18C\uAC00 \uBD80\uBAA8 \uC694\uC18C \uB0B4\uBD80\uC5D0 \uC788\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.'\r\n    });\r\n    return;\r\n  }\r\n  elementSelectionState.currentElement = target;\r\n  elementSelectionState.stack.push({ element: target });\r\n  const selectors = getChildSelectorCandidates(elementSelectionState.parentElement, target);\r\n  flashSelectionElement(target);\r\n  chrome.runtime.sendMessage({\r\n    type: 'ELEMENT_SELECTION_PICKED',\r\n    stage: 'child',\r\n    selectors,\r\n    element: buildElementPayload(target)\r\n  });\r\n  elementSelectionState.parentElement = target;\r\n  elementSelectionState.mode = null;\r\n  updateOverlayControlsState();\r\n}\r\n\r\n/**\r\n * \uD604\uC7AC \uC694\uC18C\uC5D0\uC11C \uC0C1\uC704 \uC694\uC18C\uB85C \uC774\uB3D9\uD574 \uBD80\uBAA8 \uC120\uD0DD\uC744 \uCC98\uB9AC\uD55C\uB2E4.\r\n */\r\nfunction handleParentSelection() {\r\n  if (!elementSelectionState.active || !elementSelectionState.currentElement) {\r\n    return { ok: false, reason: 'current_not_selected' };\r\n  }\r\n  let current = elementSelectionState.currentElement;\r\n  let parent = current ? current.parentElement : null;\r\n  while (parent && parent.nodeType !== 1) {\r\n    parent = parent.parentElement;\r\n  }\r\n  if (!parent) {\r\n    return { ok: false, reason: 'no_parent' };\r\n  }\r\n  elementSelectionState.currentElement = parent;\r\n  elementSelectionState.parentElement = parent;\r\n  elementSelectionState.mode = null;\r\n  applySelectionParentHighlight(parent);\r\n  flashSelectionElement(parent);\r\n  const selectors = getParentSelectorCandidates(current, parent);\r\n  chrome.runtime.sendMessage({\r\n    type: 'ELEMENT_SELECTION_PICKED',\r\n    stage: 'parent',\r\n    selectors,\r\n    element: buildElementPayload(parent)\r\n  });\r\n  updateOverlayControlsState();\r\n  return { ok: true };\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD \uBAA8\uB4DC\uC77C \uB54C \uD074\uB9AD \uC774\uBCA4\uD2B8\uB97C \uAC00\uB85C\uCC44 \uC801\uC808\uD55C \uD578\uB4E4\uB7EC\uB85C \uC804\uB2EC\uD55C\uB2E4.\r\n */\r\nfunction handleSelectionClick(event) {\r\n  if (!elementSelectionState.mode) return false;\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  event.stopImmediatePropagation();\r\n\r\n  const target = event.target;\r\n  if (!target || target === document.body || target === document.documentElement || target.id === '__ai_test_recorder_overlay__' || (target.closest && target.closest('#__ai_test_recorder_overlay__'))) {\r\n    chrome.runtime.sendMessage({\r\n      type: 'ELEMENT_SELECTION_ERROR',\r\n      stage: elementSelectionState.mode === 'child' ? 'child' : 'root',\r\n      reason: '\uC120\uD0DD\uD560 \uC218 \uC5C6\uB294 \uC601\uC5ED\uC785\uB2C8\uB2E4. \uB2E4\uB978 \uC694\uC18C\uB97C \uC120\uD0DD\uD558\uC138\uC694.'\r\n    });\r\n    return true;\r\n  }\r\n\r\n  if (elementSelectionState.mode === 'root') {\r\n    handleRootSelection(target);\r\n    return true;\r\n  }\r\n\r\n  if (elementSelectionState.mode === 'child') {\r\n    handleChildSelection(target);\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD \uBAA8\uB4DC\uC77C \uB54C \uB2E4\uB978 \uD3EC\uC778\uD130 \uC774\uBCA4\uD2B8\uAC00 \uC804\uB2EC\uB418\uC9C0 \uC54A\uB3C4\uB85D \uCC28\uB2E8\uD55C\uB2E4.\r\n */\r\nfunction interceptPointerEvent(event) {\r\n  if (!elementSelectionState.mode) return;\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n  event.stopImmediatePropagation();\r\n}\r\n\r\n/**\r\n * \uC694\uC18C \uC120\uD0DD\uC5D0 \uD544\uC694\uD55C \uC774\uBCA4\uD2B8 \uC778\uD130\uC149\uD130\uB97C \uB4F1\uB85D\uD55C\uB2E4.\r\n */\r\nexport function initSelectionInterceptors() {\r\n  document.addEventListener('click', (event) => {\r\n    if (handleSelectionClick(event)) {\r\n      // \uD074\uB9AD\uC744 \uC6B0\uB9AC\uAC00 \uC18C\uBE44\uD588\uB2E4\uBA74 \uC0AC\uC6A9\uC790\uC5D0\uAC8C \uD328\uB110 \uD655\uC778\uC744 \uC548\uB0B4\uD55C\uB2E4.\r\n      setOverlayStatus('\uC694\uC18C \uC815\uBCF4\uB97C \uD328\uB110\uC5D0\uC11C \uD655\uC778\uD558\uC138\uC694.', 'info');\r\n    }\r\n  }, true);\r\n\r\n  ['mousedown', 'mouseup', 'pointerdown', 'pointerup'].forEach((type) => {\r\n    document.addEventListener(type, interceptPointerEvent, true);\r\n  });\r\n}\r\n\r\n/**\r\n * DevTools\uC5D0\uC11C \uBD80\uBAA8 \uC120\uD0DD\uC744 \uC694\uCCAD\uD588\uC744 \uB54C \uB0B4\uBD80 \uD578\uB4E4\uB7EC\uB97C \uD638\uCD9C\uD55C\uB2E4.\r\n */\r\nexport function handleParentSelectionRequest() {\r\n  return handleParentSelection();\r\n}\r\n\r\n/**\r\n * \uD604\uC7AC \uC694\uC18C \uC120\uD0DD \uBAA8\uB4DC\uAC00 \uD65C\uC131\uD654\uB418\uC5B4 \uC788\uB294\uC9C0 \uC5EC\uBD80\uB97C \uBC18\uD658\uD55C\uB2E4.\r\n */\r\nexport function isSelectionActive() {\r\n  return elementSelectionState.active;\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD \uC0C1\uD0DC \uAC1D\uCCB4\uB97C \uADF8\uB300\uB85C \uB178\uCD9C\uD574 \uC678\uBD80\uC5D0\uC11C \uCC38\uC870\uD560 \uC218 \uC788\uAC8C \uD55C\uB2E4.\r\n */\r\nexport function getSelectionState() {\r\n  return elementSelectionState;\r\n}\r\n\r\n/**\r\n * \uC120\uD0DD \uCDE8\uC18C \uC694\uCCAD\uC744 \uCC98\uB9AC\uD558\uACE0 DevTools\uC5D0\uB3C4 \uCDE8\uC18C \uC0AC\uC2E4\uC744 \uC54C\uB9B0\uB2E4.\r\n */\r\nexport function handleSelectionCancellation() {\r\n  cancelSelection();\r\n  chrome.runtime.sendMessage({ type: 'ELEMENT_SELECTION_CANCELLED' });\r\n}\r\n", "/**\r\n * \uB179\uD654 \uC774\uBCA4\uD2B8 \uB808\uCF54\uB4DC\uC758 \uACF5\uD1B5 \uC2A4\uD0A4\uB9C8\uB97C \uC815\uC758\uD55C\uB2E4.\r\n * DOM \uCEE8\uD14D\uC2A4\uD2B8\uC640 \uAE30\uBCF8 \uC140\uB809\uD130 \uC815\uBCF4\uB97C \uD568\uAED8 \uCEA1\uCC98\uD55C\uB2E4.\r\n */\r\nimport { inferSelectorType } from '../utils/dom.js';\r\n\r\nexport const EVENT_SCHEMA_VERSION = 2;\r\n\r\n/**\r\n * \uC140\uB809\uD130 \uD6C4\uBCF4 \uBC30\uC5F4\uC5D0\uC11C \uB300\uD45C(primary) \uC140\uB809\uD130 \uC815\uBCF4\uB97C \uCD94\uCD9C\uD55C\uB2E4.\r\n * \uD6C4\uBCF4\uAC00 \uBE44\uC5B4 \uC788\uC73C\uBA74 \uBE48 \uAC1D\uCCB4\uB97C \uBC18\uD658\uD55C\uB2E4.\r\n * @param {Array<object>} selectors\r\n * @returns {object}\r\n */\r\nfunction buildPrimarySelectorData(selectors) {\r\n  if (!Array.isArray(selectors) || selectors.length === 0) return {};\r\n  const primary = selectors[0];\r\n  if (!primary || !primary.selector) return {};\r\n  const type = primary.type || inferSelectorType(primary.selector);\r\n  return {\r\n    primarySelector: primary.selector,\r\n    primarySelectorType: type,\r\n    primarySelectorText: primary.textValue || null,\r\n    primarySelectorXPath: primary.xpathValue || null,\r\n    primarySelectorMatchMode: primary.matchMode || null\r\n  };\r\n}\r\n\r\nexport function createEventRecord({\r\n  action,\r\n  value = null,\r\n  selectors = [],\r\n  target = null,\r\n  domContext = null,\r\n  iframeContext = null,\r\n  clientRect = null,\r\n  metadata = {},\r\n  manual\r\n}) {\r\n  // \uAC01 \uC774\uBCA4\uD2B8\uB294 \uC0DD\uC131 \uC2DC\uC810\uC758 \uD0C0\uC784\uC2A4\uD0EC\uD504\uB97C \uAE30\uB85D\uD55C\uB2E4.\r\n  const timestamp = Date.now();\r\n  const targetTag = target && target.tagName ? target.tagName : null;\r\n  const selectorCandidates = Array.isArray(selectors) ? selectors : [];\r\n  // \uCCAB \uBC88\uC9F8 \uD6C4\uBCF4\uB97C \uAE30\uBC18\uC73C\uB85C primary selector \uC138\uBD80 \uC815\uBCF4\uB97C \uC900\uBE44.\r\n  const primaryData = buildPrimarySelectorData(selectorCandidates);\r\n\r\n  return {\r\n    version: EVENT_SCHEMA_VERSION,\r\n    timestamp,\r\n    action,\r\n    value,\r\n    tag: targetTag,\r\n    selectorCandidates,\r\n    iframeContext,\r\n    page: {\r\n      // \uC774\uBCA4\uD2B8\uAC00 \uBC1C\uC0DD\uD55C \uD398\uC774\uC9C0\uC758 URL/\uD0C0\uC774\uD2C0\uC744 \uC800\uC7A5\uD574 \uC7AC\uD604\uC5D0 \uB3C4\uC6C0\uC744 \uC900\uB2E4.\r\n      url: window.location.href,\r\n      title: document.title\r\n    },\r\n    frame: {\r\n      iframeContext\r\n    },\r\n    target: target\r\n      ? {\r\n          tag: targetTag,\r\n          id: target.id || null,\r\n          classes: target.classList ? Array.from(target.classList) : [],\r\n          text: (target.innerText || target.textContent || '').trim().slice(0, 200),\r\n          domContext: domContext\r\n        }\r\n      : null,\r\n    clientRect,\r\n    metadata: {\r\n      schemaVersion: EVENT_SCHEMA_VERSION,\r\n      userAgent: navigator.userAgent,\r\n      ...metadata\r\n    },\r\n    manual: manual || null,\r\n    // primary selector \uAD00\uB828 \uD544\uB4DC\uB4E4\uC744 \uCD5C\uC0C1\uC704\uC5D0 \uBCD1\uD569\uD55C\uB2E4.\r\n    ...primaryData\r\n  };\r\n}\r\n\r\n", "/**\r\n * \uC0AC\uC6A9\uC790 \uC0C1\uD638\uC791\uC6A9\uC744 \uCEA1\uCC98\uD558\uC5EC \uC774\uBCA4\uD2B8 \uB808\uCF54\uB4DC\uB85C \uBCC0\uD658\uD55C\uB2E4.\r\n * \uD074\uB9AD/\uC785\uB825 \uB4F1\uC758 DOM \uC774\uBCA4\uD2B8\uB97C \uAC10\uC9C0\uD558\uACE0 Chrome \uC2A4\uD1A0\uB9AC\uC9C0 \uBC0F\r\n * DevTools \uD328\uB110\uB85C \uC804\uB2EC\uD55C\uB2E4.\r\n */\r\nimport { createEventRecord } from '../events/schema.js';\r\nimport { getIframeContext, getSelectorCandidates } from '../selectors/index.js';\r\nimport { elementSelectionState, inputTimers, recorderState } from '../state.js';\r\nimport { ensureRecordingState, removeHighlight } from '../overlay/index.js';\r\nimport { buildDomContextSnapshot } from '../utils/dom.js';\r\n\r\nconst INPUT_DEBOUNCE_DELAY = 800;\r\n\r\n/**\r\n * \uC0DD\uC131\uB41C \uC774\uBCA4\uD2B8 \uB808\uCF54\uB4DC\uB97C \uBC31\uADF8\uB77C\uC6B4\uB4DC\uC5D0 \uC800\uC7A5 \uC694\uCCAD\uD55C\uB2E4.\r\n */\r\nfunction persistEvent(eventRecord) {\r\n  chrome.runtime.sendMessage({ type: 'SAVE_EVENT', event: eventRecord }, () => {});\r\n}\r\n\r\n/**\r\n * \uC0C8 \uC774\uBCA4\uD2B8\uB97C DevTools \uD328\uB110\uB85C \uBE0C\uB85C\uB4DC\uCE90\uC2A4\uD2B8\uD55C\uB2E4.\r\n */\r\nfunction broadcastRecordedEvent(eventRecord) {\r\n  chrome.runtime.sendMessage({ type: 'EVENT_RECORDED', event: eventRecord }, () => {});\r\n}\r\n\r\n/**\r\n * \uB300\uC0C1 \uC694\uC18C\uC758 \uD654\uBA74 \uC88C\uD45C/\uD06C\uAE30\uB97C \uBC18\uC62C\uB9BC\uD574 \uBC18\uD658\uD55C\uB2E4.\r\n */\r\nfunction buildClientRect(target) {\r\n  if (!target || typeof target.getBoundingClientRect !== 'function') {\r\n    return { x: 0, y: 0, w: 0, h: 0 };\r\n  }\r\n  const rect = target.getBoundingClientRect();\r\n  return {\r\n    x: Math.round(rect.x || 0),\r\n    y: Math.round(rect.y || 0),\r\n    w: Math.round(rect.width || 0),\r\n    h: Math.round(rect.height || 0)\r\n  };\r\n}\r\n\r\n/**\r\n * DOM \uC774\uBCA4\uD2B8\uC5D0\uC11C \uD544\uC694\uD55C \uBD80\uAC00 \uC815\uBCF4(\uC140\uB809\uD130, iframe \uB4F1)\uB97C \uBAA8\uC544 eventRecord\uB97C \uB9CC\uB4E0\uB2E4.\r\n */\r\nfunction buildEventForTarget({ action, target, value = null }) {\r\n  const selectors = getSelectorCandidates(target) || [];\r\n  const iframeContext = getIframeContext(target);\r\n  const clientRect = buildClientRect(target);\r\n  const metadata = { domEvent: action };\r\n  const domContext = buildDomContextSnapshot(target);\r\n  const eventRecord = createEventRecord({\r\n    action,\r\n    value,\r\n    selectors,\r\n    target,\r\n    iframeContext,\r\n    clientRect,\r\n    metadata,\r\n    domContext\r\n  });\r\n  return {\r\n    ...eventRecord,\r\n    selectorCandidates: selectors,\r\n    iframeContext,\r\n    domContext,\r\n    tag: target && target.tagName ? target.tagName : null\r\n  };\r\n}\r\n\r\n/**\r\n * \uC774\uBCA4\uD2B8\uB97C \uC0DD\uC131\uD558\uACE0 \uC800\uC7A5/\uBC29\uC1A1\uAE4C\uC9C0 \uC218\uD589\uD558\uB294 \uD5EC\uD37C.\r\n */\r\nfunction recordDomEvent({ action, target, value }) {\r\n  if (!target) return;\r\n  const eventRecord = buildEventForTarget({ action, target, value });\r\n  persistEvent(eventRecord);\r\n  broadcastRecordedEvent(eventRecord);\r\n}\r\n\r\n/**\r\n * \uD074\uB9AD \uC774\uBCA4\uD2B8\uB97C \uAC10\uC9C0\uD574 \uB179\uD654 \uC911\uC77C \uB54C\uB9CC \uAE30\uB85D\uD55C\uB2E4.\r\n */\r\nfunction handleClick(event) {\r\n  if (!recorderState.isRecording) return;\r\n  if (elementSelectionState.mode) return;\r\n  const target = event.target;\r\n  if (!target || target === document.body || target === document.documentElement) return;\r\n  if (target.id === '__ai_test_recorder_overlay__' || (target.closest && target.closest('#__ai_test_recorder_overlay__'))) {\r\n    return;\r\n  }\r\n  recordDomEvent({ action: 'click', target });\r\n}\r\n\r\n/**\r\n * \uC785\uB825 \uC774\uBCA4\uD2B8\uB294 debounce\uB97C \uC801\uC6A9\uD574 \uB9C8\uC9C0\uB9C9 \uAC12\uB9CC \uC800\uC7A5\uD55C\uB2E4.\r\n */\r\nfunction handleInput(event) {\r\n  if (!recorderState.isRecording) return;\r\n  const target = event.target;\r\n  if (!target || (target.tagName !== 'INPUT' && target.tagName !== 'TEXTAREA' && !target.isContentEditable)) {\r\n    return;\r\n  }\r\n  const existingTimer = inputTimers.get(target);\r\n  if (existingTimer) {\r\n    clearTimeout(existingTimer);\r\n  }\r\n  const timer = setTimeout(() => {\r\n    recordDomEvent({ action: 'input', target, value: target.value || target.textContent || '' });\r\n    inputTimers.delete(target);\r\n  }, INPUT_DEBOUNCE_DELAY);\r\n  inputTimers.set(target, timer);\r\n}\r\n\r\n/**\r\n * \uD3EC\uCEE4\uC2A4\uB97C \uC783\uC744 \uB54C\uB3C4 debounce\uB97C \uD574\uC81C\uD558\uACE0 \uCD5C\uC885 \uAC12\uC744 \uAE30\uB85D\uD55C\uB2E4.\r\n */\r\nfunction handleBlur(event) {\r\n  if (!recorderState.isRecording) return;\r\n  const target = event.target;\r\n  if (!target || (target.tagName !== 'INPUT' && target.tagName !== 'TEXTAREA' && !target.isContentEditable)) {\r\n    return;\r\n  }\r\n  const existingTimer = inputTimers.get(target);\r\n  if (existingTimer) {\r\n    clearTimeout(existingTimer);\r\n    inputTimers.delete(target);\r\n    recordDomEvent({ action: 'input', target, value: target.value || target.textContent || '' });\r\n  }\r\n}\r\n\r\nexport function startRecording(options = {}) {\r\n  const { resetEvents = true } = options;\r\n  if (recorderState.isRecording) {\r\n    // \uC774\uBBF8 \uB179\uD654 \uC911\uC774\uBA74 \uC0C1\uD0DC\uB9CC \uC7AC\uD655\uC778\uD558\uACE0 \uD544\uC694\uD55C \uACBD\uC6B0 \uC774\uBCA4\uD2B8 \uBC30\uC5F4 \uCD08\uAE30\uD654.\r\n    ensureRecordingState(true);\r\n    if (resetEvents) {\r\n      chrome.storage.local.set({ events: [], recording: true });\r\n    } else {\r\n      chrome.storage.local.set({ recording: true });\r\n    }\r\n    return;\r\n  }\r\n  recorderState.isRecording = true;\r\n  ensureRecordingState(true);\r\n  if (resetEvents) {\r\n    chrome.storage.local.set({ events: [], recording: true });\r\n  } else {\r\n    chrome.storage.local.set({ recording: true });\r\n  }\r\n  removeHighlight();\r\n}\r\n\r\nexport function stopRecording() {\r\n  recorderState.isRecording = false;\r\n  ensureRecordingState(false);\r\n  chrome.storage.local.remove(['recording']);\r\n  // \uB179\uD654\uB97C \uBA48\uCD9C \uB54C \uD558\uC774\uB77C\uC774\uD2B8\uB294 \uC815\uB9AC\uD574 UI \uD63C\uC120\uC744 \uC904\uC778\uB2E4.\r\n  removeHighlight();\r\n}\r\n\r\nexport function initRecorderListeners() {\r\n  document.addEventListener('click', (event) => {\r\n    try {\r\n      // \uCEA1\uCC98 \uC2E4\uD328 \uC2DC \uC804\uCCB4 \uB179\uD654\uB97C \uC911\uB2E8\uD558\uC9C0 \uC54A\uB3C4\uB85D try/catch \uCC98\uB9AC.\r\n      handleClick(event);\r\n    } catch (err) {\r\n      console.error('[AI Test Recorder] Failed to handle click event:', err);\r\n    }\r\n  }, true);\r\n\r\n  document.addEventListener('input', (event) => {\r\n    try {\r\n      handleInput(event);\r\n    } catch (err) {\r\n      // \uB2E4\uB978 \uC774\uBCA4\uD2B8 \uD578\uB4E4\uB9C1\uC5D0 \uC601\uD5A5\uC774 \uC5C6\uB3C4\uB85D \uB85C\uADF8\uB9CC \uCD9C\uB825.\r\n      console.error('[AI Test Recorder] Failed to handle input event:', err);\r\n    }\r\n  }, true);\r\n\r\n  document.addEventListener('blur', (event) => {\r\n    try {\r\n      handleBlur(event);\r\n    } catch (err) {\r\n      console.error('[AI Test Recorder] Failed to handle blur event:', err);\r\n    }\r\n  }, true);\r\n}\r\n\r\nexport function getRecordingState() {\r\n  return recorderState.isRecording;\r\n}\r\n", "/**\r\n * \uBC31\uADF8\uB77C\uC6B4\uB4DC/\uD328\uB110\uACFC \uCF58\uD150\uCE20 \uC2A4\uD06C\uB9BD\uD2B8 \uAC04 \uBA54\uC2DC\uC9C0 \uBE0C\uB9AC\uC9C0.\r\n * \uAC01 \uBA54\uC2DC\uC9C0 \uD0C0\uC785\uC5D0 \uB300\uC751\uD558\uB294 \uB3D9\uC791\uC744 \uB77C\uC6B0\uD305\uD55C\uB2E4.\r\n */\r\nimport { executeSelectionAction } from '../replay/index.js';\r\nimport { executeReplayStep } from '../replay/index.js';\r\nimport { beginChildSelection, beginRootSelection, cancelSelection, handleParentSelectionRequest } from '../selection/index.js';\r\nimport { getRecordingState, startRecording, stopRecording } from '../recorder/index.js';\r\nimport { ensureRecordingState, setOverlayVisibility, isOverlayVisible } from '../overlay/index.js';\r\nimport { countMatchesForSelector, parseSelectorForMatching } from '../utils/dom.js';\r\n\r\n/**\r\n * \uBC31\uADF8\uB77C\uC6B4\uB4DC/DevTools\uC640\uC758 \uBA54\uC2DC\uC9C0 \uBE0C\uB9AC\uC9C0\uB97C \uCD08\uAE30\uD654\uD55C\uB2E4.\r\n * \uAC01 \uBA54\uC2DC\uC9C0 \uD0C0\uC785\uBCC4\uB85C \uB300\uC751 \uB3D9\uC791\uC744 \uC218\uD589\uD558\uACE0 \uC751\uB2F5\uC744 \uB3CC\uB824\uC900\uB2E4.\r\n */\r\nexport function initMessageBridge() {\r\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n    (async () => {\r\n      if (!message || typeof message !== 'object') {\r\n        sendResponse({ ok: false, reason: 'invalid_message' });\r\n        return;\r\n      }\r\n\r\n      switch (message.type) {\r\n        case 'CHECK_RECORDING_STATUS': {\r\n          // \uD604\uC7AC \uB179\uD654 \uC5EC\uBD80\uB9CC \uC870\uD68C.\r\n          sendResponse({ recording: getRecordingState() });\r\n          return;\r\n        }\r\n        case 'RECORDING_START': {\r\n          // \uB179\uD654\uB97C \uC2DC\uC791\uD558\uBA74\uC11C \uAE30\uC874 \uC774\uBCA4\uD2B8\uB97C \uCD08\uAE30\uD654.\r\n          startRecording({ resetEvents: true });\r\n          sendResponse({ ok: true });\r\n          return;\r\n        }\r\n        case 'RECORDING_STOP': {\r\n          // \uB179\uD654\uB97C \uC911\uB2E8\uD558\uACE0 \uC0C1\uD0DC\uB97C false\uB85C \uC804\uD658.\r\n          stopRecording();\r\n          sendResponse({ ok: true });\r\n          return;\r\n        }\r\n        case 'ELEMENT_SELECTION_START': {\r\n          // \uB8E8\uD2B8 \uC694\uC18C \uC120\uD0DD\uC744 \uC2DC\uC791\uD574 overlay\uAC00 \uC694\uC18C\uB97C \uBC1B\uC744 \uC900\uBE44\uB97C \uD55C\uB2E4.\r\n          beginRootSelection();\r\n          sendResponse({ ok: true });\r\n          return;\r\n        }\r\n        case 'ELEMENT_SELECTION_PICK_CHILD': {\r\n          // \uD604\uC7AC \uC120\uD0DD\uB41C \uBD80\uBAA8 \uAE30\uC900\uC73C\uB85C \uC790\uC2DD \uC120\uD0DD \uBAA8\uB4DC\uB97C \uC2DC\uC791.\r\n          const result = beginChildSelection();\r\n          sendResponse(result);\r\n          return;\r\n        }\r\n        case 'ELEMENT_SELECTION_PICK_PARENT': {\r\n          // \uD604\uC7AC \uC120\uD0DD\uC5D0\uC11C \uD55C \uB2E8\uACC4 \uC0C1\uC704\uB85C \uC774\uB3D9.\r\n          const result = handleParentSelectionRequest();\r\n          sendResponse(result);\r\n          return;\r\n        }\r\n        case 'ELEMENT_SELECTION_CANCEL': {\r\n          cancelSelection();\r\n          // \uD328\uB110 \uCE21\uC5D0\uB3C4 \uC120\uD0DD\uC774 \uCDE8\uC18C\uB418\uC5C8\uC74C\uC744 \uC54C\uB824\uC900\uB2E4.\r\n          cancelSelection();\r\n          chrome.runtime.sendMessage({ type: 'ELEMENT_SELECTION_CANCELLED' });\r\n          sendResponse({ ok: true });\r\n          return;\r\n        }\r\n        case 'ELEMENT_SELECTION_EXECUTE': {\r\n          // \uC120\uD0DD \uC6CC\uD06C\uD50C\uB85C\uC6B0\uC5D0\uC11C \uC694\uCCAD\uD55C \uD074\uB9AD/\uCD94\uCD9C \uB4F1\uC758 \uB3D9\uC791\uC744 \uC989\uC2DC \uC2E4\uD589.\r\n          const { path = [], action = '' } = message;\r\n          const result = executeSelectionAction(action, path);\r\n          sendResponse(result);\r\n          return;\r\n        }\r\n        case 'REPLAY_EXECUTE_STEP': {\r\n          // \uB179\uD654\uB41C \uC774\uBCA4\uD2B8 \uD55C \uC2A4\uD15D\uC744 \uC2E4\uD589. \uBE44\uB3D9\uAE30\uB85C \uCC98\uB9AC \uD6C4 \uACB0\uACFC\uB97C \uC751\uB2F5.\r\n          const payload = await executeReplayStep({\r\n            event: message.event,\r\n            index: message.index,\r\n            total: message.total,\r\n            timeoutMs: message.timeoutMs || 6000\r\n          });\r\n          sendResponse(payload);\r\n          return;\r\n        }\r\n        case 'OVERLAY_SET_RECORDING': {\r\n          // overlay \uD1A0\uAE00\uC774 \uB179\uD654 \uC0C1\uD0DC\uB97C \uBCC0\uACBD\uD558\uB824 \uD560 \uB54C \uD638\uCD9C.\r\n          ensureRecordingState(!!message.recording);\r\n          sendResponse({ ok: true });\r\n          return;\r\n        }\r\n        case 'OVERLAY_VISIBILITY_SET': {\r\n          // overlay \uD45C\uC2DC/\uC228\uAE40.\r\n          setOverlayVisibility(!!message.visible, { notify: message.notify !== false });\r\n          sendResponse({ ok: true, visible: isOverlayVisible() });\r\n          return;\r\n        }\r\n        case 'OVERLAY_VISIBILITY_GET': {\r\n          // overlay \uD604\uC7AC \uC0C1\uD0DC\uB97C \uC870\uD68C.\r\n          sendResponse({ ok: true, visible: isOverlayVisible() });\r\n          return;\r\n        }\r\n        case 'EVALUATE_SELECTORS': {\r\n          const selectors = Array.isArray(message.selectors) ? message.selectors : [];\r\n          const results = selectors.map((entry) => {\r\n            const info = entry && typeof entry === 'object' ? entry : { selector: entry };\r\n            const selector = typeof info.selector === 'string' ? info.selector.trim() : '';\r\n            const type = typeof info.type === 'string' ? info.type : undefined;\r\n            const matchMode = typeof info.matchMode === 'string' ? info.matchMode : undefined;\r\n            if (!selector) {\r\n              // \uC140\uB809\uD130\uAC00 \uBE44\uC5B4 \uC788\uB2E4\uBA74 \uC989\uC2DC \uC2E4\uD328 \uC815\uBCF4 \uBC18\uD658.\r\n              return { selector: '', matchCount: 0, unique: false, error: 'invalid_selector' };\r\n            }\r\n            try {\r\n              // \uD30C\uC2F1\uD55C \uC140\uB809\uD130\uB97C \uBB38\uC11C\uC5D0 \uC801\uC6A9\uD574 \uB9E4\uCE6D \uAC1C\uC218\uB97C \uACC4\uC0B0\uD55C\uB2E4.\r\n              const parsed = parseSelectorForMatching(selector, type);\r\n              const count = countMatchesForSelector(parsed, document, { matchMode });\r\n              return {\r\n                selector,\r\n                type: parsed.type || type || null,\r\n                matchCount: count,\r\n                unique: count === 1\r\n              };\r\n            } catch (err) {\r\n              // \uD30C\uC2F1/\uD3C9\uAC00 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uBA74 \uC5D0\uB7EC \uBA54\uC2DC\uC9C0 \uD3EC\uD568.\r\n              return {\r\n                selector,\r\n                type: type || null,\r\n                matchCount: 0,\r\n                unique: false,\r\n                error: err && err.message ? err.message : 'evaluation_failed'\r\n              };\r\n            }\r\n          });\r\n          sendResponse({ ok: true, results });\r\n          return;\r\n        }\r\n        default: {\r\n          // \uC815\uC758\uB418\uC9C0 \uC54A\uC740 type\uC740 \uC5D0\uB7EC \uC751\uB2F5.\r\n          sendResponse({ ok: false, reason: 'unknown_message_type' });\r\n        }\r\n      }\r\n    })();\r\n    return true;\r\n  });\r\n}\r\n\r\n", "/**\r\n * \uCF58\uD150\uCE20 \uC2A4\uD06C\uB9BD\uD2B8 \uCD08\uAE30\uD654 \uB8E8\uD2F4\uC744 \uC815\uC758\uD55C\uB2E4.\r\n * \uC624\uBC84\uB808\uC774/\uB179\uD654/\uC120\uD0DD \uBC0F \uBA54\uC2DC\uC9D5 \uC2DC\uC2A4\uD15C\uC744 \uC900\uBE44\uD558\uACE0\r\n * \uC774\uC804 \uB179\uD654 \uC0C1\uD0DC\uB97C \uBCF5\uC6D0\uD55C\uB2E4.\r\n */\r\nimport { initMessageBridge } from './messaging/index.js';\r\nimport { initRecorderListeners, startRecording, stopRecording } from './recorder/index.js';\r\nimport { initOverlaySystem, ensureRecordingState, removeHighlight } from './overlay/index.js';\r\nimport { initSelectionInterceptors } from './selection/index.js';\r\nimport { recorderState } from './state.js';\r\n\r\nconst GLOBAL_FLAG = '__ai_test_recorder_loaded';\r\n\r\nfunction restoreRecordingState() {\r\n  chrome.storage.local.get(['recording'], (result) => {\r\n    if (result.recording) {\r\n      if (!recorderState.isRecording) {\r\n        recorderState.isRecording = true;\r\n        ensureRecordingState(true);\r\n      }\r\n      startRecording({ resetEvents: false });\r\n    } else {\r\n      ensureRecordingState(false);\r\n      removeHighlight();\r\n    }\r\n  });\r\n}\r\n\r\nexport function initializeContentScript() {\r\n  if (window[GLOBAL_FLAG]) return;\r\n  window[GLOBAL_FLAG] = true;\r\n\r\n  initOverlaySystem();\r\n  initRecorderListeners();\r\n  initSelectionInterceptors();\r\n  initMessageBridge();\r\n  restoreRecordingState();\r\n}\r\n\r\n", "/**\r\n * \uCF58\uD150\uCE20 \uC2A4\uD06C\uB9BD\uD2B8 \uC9C4\uC785\uC810.\r\n * \uBB38\uC11C \uC900\uBE44 \uC0C1\uD0DC\uC5D0 \uB530\uB77C \uCD08\uAE30\uD654 \uD568\uC218\uB97C \uD55C \uBC88\uB9CC \uC2E4\uD589\uD55C\uB2E4.\r\n */\r\nimport { initializeContentScript } from './init.js';\r\n\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', initializeContentScript, { once: true });\r\n} else {\r\n  initializeContentScript();\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": ["count", "payload"]
}
